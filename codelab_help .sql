-- phpMyAdmin SQL Dump
-- version 5.2.1
-- https://www.phpmyadmin.net/
--
-- Host: 127.0.0.1
-- Generation Time: Nov 20, 2025 at 06:32 AM
-- Server version: 10.4.32-MariaDB
-- PHP Version: 8.2.12

SET SQL_MODE = "NO_AUTO_VALUE_ON_ZERO";
START TRANSACTION;
SET time_zone = "+00:00";


/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!40101 SET NAMES utf8mb4 */;

--
-- Database: `codelab@help`
--

-- --------------------------------------------------------

--
-- Table structure for table `assignments`
--

CREATE TABLE `assignments` (
  `id` int(10) UNSIGNED NOT NULL,
  `exercise_id` int(10) UNSIGNED NOT NULL,
  `instructor_id` int(10) UNSIGNED NOT NULL,
  `student_id` int(10) UNSIGNED DEFAULT NULL,
  `title` varchar(200) NOT NULL,
  `description` text DEFAULT NULL,
  `due_date` datetime DEFAULT NULL,
  `status` enum('pending','submitted','graded') DEFAULT 'pending',
  `grade` int(11) DEFAULT NULL,
  `feedback` text DEFAULT NULL,
  `submitted_at` datetime DEFAULT NULL,
  `graded_at` datetime DEFAULT NULL,
  `updated_at` timestamp NOT NULL DEFAULT current_timestamp() ON UPDATE current_timestamp(),
  `created_at` timestamp NOT NULL DEFAULT current_timestamp()
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

--
-- Dumping data for table `assignments`
--

INSERT INTO `assignments` (`id`, `exercise_id`, `instructor_id`, `student_id`, `title`, `description`, `due_date`, `status`, `grade`, `feedback`, `submitted_at`, `graded_at`, `updated_at`, `created_at`) VALUES
(1, 1, 4, NULL, 'sadvsad', 'asvdadvva', '2021-12-12 18:30:00', 'pending', NULL, NULL, NULL, NULL, '2025-11-19 18:28:20', '2025-10-02 13:28:04'),
(2, 1, 4, NULL, 'sadvsad', 'asvdadvva', '2021-12-12 18:30:00', 'pending', NULL, NULL, NULL, NULL, '2025-11-19 18:28:20', '2025-10-02 13:33:13'),
(3, 2, 4, 5, 'Style a Button', '', '2025-12-12 23:59:59', 'submitted', 80, 'Good job!', '2025-11-20 10:37:49', '2025-11-20 05:08:59', '2025-11-20 02:37:49', '2025-11-19 18:29:02'),
(4, 5, 4, 5, 'dbf', '', '2030-02-02 23:59:59', 'graded', 100, 'GOOD JOB!', '2025-11-20 10:43:34', '2025-11-20 10:49:59', '2025-11-20 02:49:59', '2025-11-19 19:02:58'),
(5, 5, 4, 3, 'dbf', '', '2030-02-02 23:59:59', 'pending', NULL, NULL, NULL, NULL, '2025-11-19 19:02:58', '2025-11-19 19:02:58'),
(6, 6, 4, 5, 'a', '', '2025-11-23 23:59:59', 'pending', NULL, NULL, NULL, NULL, '2025-11-20 02:50:57', '2025-11-20 02:50:57'),
(7, 6, 4, 3, 'a', '', '2025-11-23 23:59:59', 'pending', NULL, NULL, NULL, NULL, '2025-11-20 02:50:57', '2025-11-20 02:50:57'),
(8, 9, 4, 5, 'HTML Test', '', '2025-11-25 23:59:59', 'submitted', NULL, NULL, '2025-11-20 12:00:09', NULL, '2025-11-20 04:00:09', '2025-11-20 02:55:39'),
(9, 9, 4, 3, 'HTML Test', '', '2025-11-25 23:59:59', 'pending', NULL, NULL, NULL, NULL, '2025-11-20 02:55:39', '2025-11-20 02:55:39'),
(10, 10, 4, 5, 'Test HTML', '', '2025-12-29 23:59:59', 'pending', NULL, NULL, NULL, NULL, '2025-11-20 04:02:05', '2025-11-20 04:02:05'),
(11, 10, 4, 3, 'Test HTML', '', '2025-12-29 23:59:59', 'pending', NULL, NULL, NULL, NULL, '2025-11-20 04:02:05', '2025-11-20 04:02:05');

-- --------------------------------------------------------

--
-- Table structure for table `assignment_students`
--

CREATE TABLE `assignment_students` (
  `id` int(10) UNSIGNED NOT NULL,
  `assignment_id` int(10) UNSIGNED NOT NULL,
  `student_id` int(10) UNSIGNED NOT NULL,
  `status` enum('pending','in_progress','submitted','graded') DEFAULT 'pending',
  `attempts` int(11) DEFAULT 0
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `exercises`
--

CREATE TABLE `exercises` (
  `id` int(10) UNSIGNED NOT NULL,
  `lesson_id` int(10) UNSIGNED NOT NULL,
  `title` varchar(200) NOT NULL,
  `description` text DEFAULT NULL,
  `instructions` text NOT NULL,
  `starter_code` text DEFAULT NULL,
  `solution_code` text DEFAULT NULL,
  `test_cases` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL CHECK (json_valid(`test_cases`)),
  `hints` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL CHECK (json_valid(`hints`)),
  `points` int(11) DEFAULT 10,
  `difficulty` enum('easy','medium','hard') DEFAULT 'easy',
  `order_index` int(11) DEFAULT 0,
  `created_at` timestamp NOT NULL DEFAULT current_timestamp()
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

--
-- Dumping data for table `exercises`
--

INSERT INTO `exercises` (`id`, `lesson_id`, `title`, `description`, `instructions`, `starter_code`, `solution_code`, `test_cases`, `hints`, `points`, `difficulty`, `order_index`, `created_at`) VALUES
(1, 1, 'Create a Basic HTML Page', 'Build your first HTML page with proper structure', 'Create an HTML page with:\n1. DOCTYPE declaration\n2. Head section with title\n3. Body with h1 and p tags', '<!-- Write your HTML here -->\n', '<!DOCTYPE html>\n<html>\n<head>\n  <title>My Page</title>\n</head>\n<body>\n  <h1>Hello World</h1>\n  <p>This is my first page</p>\n</body>\n</html>', NULL, NULL, 10, 'easy', 0, '2025-10-02 03:09:33'),
(2, 2, 'Style a Button', 'Create and style a modern button using CSS', 'Style a button with:\n1. Background color\n2. Padding\n3. Border radius\n4. Hover effect', '<button class=\"btn\">Click Me</button>\n\n<style>\n.btn {\n  /* Add your CSS here */\n}\n</style>', '<button class=\"btn\">Click Me</button>\n\n<style>\n.btn {\n  background-color: #358efb;\n  color: white;\n  padding: 10px 20px;\n  border: none;\n  border-radius: 5px;\n  cursor: pointer;\n}\n.btn:hover {\n  background-color: #2a72c9;\n}\n</style>', NULL, NULL, 15, 'easy', 0, '2025-10-02 03:09:33'),
(4, 6, 'a', 'a', 'a', 'a', 'a', NULL, NULL, 10, 'easy', 0, '2025-11-19 18:40:38'),
(5, 1, 'dbf', 'dfbdf', 'fbdf', 'dbdf', 'dfbfd', NULL, NULL, 10, 'easy', 0, '2025-11-19 18:41:18'),
(6, 6, 'a', 'a', 'a', 'a', 'a', NULL, NULL, 10, 'easy', 0, '2025-11-19 19:03:11'),
(7, 2, 'Test', 'Test', 'Test', '//Test', '//Test', NULL, NULL, 10, 'easy', 0, '2025-11-19 21:16:39'),
(8, 2, 'Test', 'Test', 'Test', '<p>Test<p>', '<p>Test<p>', NULL, NULL, 10, 'easy', 0, '2025-11-20 02:50:36'),
(9, 1, 'HTML Test', 'HTML Test', 'Write HTML Test with <p>', '<p>HTML Test<p>', '<p>HTML Test<p>', NULL, NULL, 10, 'easy', 0, '2025-11-20 02:54:57'),
(10, 1, 'Test HTML', 'Test HTML', 'Test HTML', 'Test HTML', 'Test HTML', NULL, NULL, 10, 'easy', 0, '2025-11-20 04:01:06');

-- --------------------------------------------------------

--
-- Table structure for table `exercise_submissions`
--

CREATE TABLE `exercise_submissions` (
  `id` int(10) UNSIGNED NOT NULL,
  `exercise_id` int(10) UNSIGNED NOT NULL,
  `student_id` int(10) UNSIGNED NOT NULL,
  `submitted_code` text NOT NULL,
  `status` enum('pending','passed','failed') DEFAULT 'pending',
  `score` int(11) DEFAULT 0,
  `feedback` text DEFAULT NULL,
  `passed_tests` int(11) DEFAULT 0,
  `total_tests` int(11) DEFAULT 0,
  `submitted_at` timestamp NOT NULL DEFAULT current_timestamp()
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

--
-- Dumping data for table `exercise_submissions`
--

INSERT INTO `exercise_submissions` (`id`, `exercise_id`, `student_id`, `submitted_code`, `status`, `score`, `feedback`, `passed_tests`, `total_tests`, `submitted_at`) VALUES
(1, 1, 3, '<!-- Write your HTML here -->\nsdvsdsd', 'failed', 0, 'Your solution needs improvement. Issue: Code seems too short for a complete solution. Consider: Using functions for better code organization. ', 0, 3, '2025-10-02 13:01:01'),
(2, 1, 3, '<!-- Write your HTML here -->\nsdvsdsdsdvsvsdsdvsdvsdvsdvsvd', 'failed', 3, 'Your solution needs improvement. Good: Code has substantial implementation. Consider: Using functions for better code organization. ', 1, 3, '2025-10-02 13:01:08'),
(3, 1, 3, '<!-- Write your HTML here -->\nsdvsdsdsdvsvsdsdvsdvsdvsdvsvd\n\n<?php \nsession_start(); \n\n// Security: Check if user is logged in\nif (!isset($_SESSION[\'user_id\'])) {\n    header(\"Location: login.php\");\n    exit();\n}\n\n// Get user information\n$user_name = $_SESSION[\'full_name\'];\n$user_role = $_SESSION[\'role\'];\n?>\n<!DOCTYPE html>\n<html lang=\"en\">\n<style>\n    body {\n    margin: 0;\n    font-family: \'Segoe UI\', sans-serif;\n    background-color: #2e3f54;\n    color: white;\n    }\n\n    /* Navbar */\n    .navbar {\n    background-color: #111;\n    padding: 1rem 2rem;\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    }\n\n    .logo {\n    color: white;\n    font-weight: bold;\n    font-size: 1.2rem;\n    }\n\n    .nav-links {\n    list-style: none;\n    display: flex;\n    gap: 1.5rem;\n    }\n\n    .nav-links li a {\n    color: white;\n    text-decoration: none;\n    }\n\n    .nav-icons {\n    display: flex;\n    align-items: center;\n    gap: 1rem;\n    }\n\n    .icon {\n    font-size: 1.2rem;\n    }\n\n    .username {\n    font-weight: bold;\n    }\n\n    .logout-btn {\n    background-color: #2e3f54;\n    color: white;\n    border: none;\n    padding: 0.4rem 1rem;\n    border-radius: 5px;\n    cursor: pointer;\n    }\n\n    /* Main content */\n    .browse-container {\n    padding: 2rem;\n    }\n\n    .browse-container h2 {\n    font-size: 2rem;\n    margin-bottom: 1rem;\n    }\n\n    /* Tabs */\n    .tabs {\n    display: flex;\n    gap: 2rem;\n    margin-bottom: 2rem;\n    border-bottom: 2px solid white;\n    padding-bottom: 0.5rem;\n    }\n\n    .tab {\n    background: none;\n    border: none;\n    color: white;\n    font-size: 1rem;\n    padding: 0.5rem;\n    cursor: pointer;\n    position: relative;\n    }\n\n    .tab.active::after {\n    content: \"\";\n    position: absolute;\n    bottom: -2px;\n    left: 0;\n    right: 0;\n    height: 3px;\n    background-color: white;\n    }\n\n    /* Lesson cards */\n    .section-title {\n    margin-top: 2rem;\n    font-size: 1.3rem;\n    }\n\n    .lessons-grid {\n    display: flex;\n    gap: 2rem;\n    flex-wrap: wrap;\n    margin-top: 1rem;\n    }\n\n    .lesson-card {\n    background-color: white;\n    color: black;\n    padding: 1rem;\n    border-radius: 1rem;\n    text-align: center;\n    width: 150px;\n    transition: transform 0.2s;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    }\n\n    .lesson-card img {\n    max-width: 100px;\n    height: auto;\n    margin-bottom: 0.5rem;\n    }\n\n    .lesson-card:hover {\n    transform: scale(1.05);\n    }\n    .logo a {\n      color: white;\n      text-decoration: none;\n    }\n    .logo a:hover {\n    text-decoration: underline;\n    }\n</style>\n<head>\n  <meta charset=\"UTF-8\" />\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"/>\n  <title>Browse lessons and tutorials</title>\n</head>\n<body>\n\n  <!-- Navbar -->\n  <nav class=\"navbar\">\n    <div class=\"logo\">\n        <a href=\"<?php\n            echo ($user_role === \'student\') ? \'studentDashboard.php\' :\n                (($user_role === \'instructor\') ? \'instructorDashboard.php\' : \n                (($user_role === \'admin\') ? \'adminDashboard.php\' : \'#\'));\n        ?>\" style=\"color: white; text-decoration: none;\">\n            Code Lab @ HELP\n        </a>\n    </div>\n    <ul class=\"nav-links\">\n        <li>\n            <a href=\"<?php\n                echo ($user_role === \'student\') ? \'studentDashboard.php\' :\n                    (($user_role === \'instructor\') ? \'instructorDashboard.php\' : \n                    (($user_role === \'admin\') ? \'adminDashboard.php\' : \'#\'));\n            ?>\">Dashboard</a>\n        </li>\n      <li><a href=\"browser.php\">Browse</a></li>\n      <li><a href=\"#\">Reports</a></li>\n      <li><a href=\"#\">Feedback</a></li>\n    </ul>\n    <div class=\"nav-icons\">\n      <span class=\"icon\">üîî</span>\n      <span class=\"icon\">‚öôÔ∏è</span>\n      <span class=\"icon\">üë§</span>\n      <span class=\"username\"><?php echo htmlspecialchars($user_name); ?></span>\n      <button class=\"logout-btn\" onclick=\"confirmLogout()\">Log Out</button>\n    </div>\n  </nav>\n\n  <main class=\"browse-container\">\n    <h2>Browse lessons and tutorials</h2>\n\n    <!-- Filter Tabs -->\n    <div class=\"tabs\">\n      <button class=\"tab active\" onclick=\"filterLessons(\'all\', this)\">All</button>\n      <button class=\"tab\" onclick=\"filterLessons(\'frontend\', this)\">Frontend Development</button>\n      <button class=\"tab\" onclick=\"filterLessons(\'backend\', this)\">Backend Development</button>\n    </div>\n\n    <h3 class=\"section-title\">Newly Added</h3>\n    <div class=\"lessons-grid\">\n        <div class=\"lesson-card\" data-category=\"frontend\" onclick=\"window.location.href=\'exercises.php\'\">\n          <img src=\"https://upload.wikimedia.org/wikipedia/commons/6/61/HTML5_logo_and_wordmark.svg\" alt=\"HTML5\">\n          <p>HTML Lessons</p>\n        </div>\n        <div class=\"lesson-card\" data-category=\"frontend\" onclick=\"window.location.href=\'exercises.php\'\">\n          <img src=\"https://upload.wikimedia.org/wikipedia/commons/d/d5/CSS3_logo_and_wordmark.svg\" alt=\"CSS3\">\n          <p>CSS Lessons</p>\n        </div>\n        <div class=\"lesson-card\" data-category=\"backend\" onclick=\"window.location.href=\'exercises.php\'\">\n          <img src=\"https://upload.wikimedia.org/wikipedia/commons/6/6a/JavaScript-logo.png\" alt=\"JavaScript\">\n          <p>JavaScript Lessons</p>\n        </div>\n      </div>\n    </div>\n  </main>\n\n  <script>\n    function confirmLogout() {\n      if (confirm(\"Are you sure you want to log out?\")) {\n        window.location.href = \'logout.php\';\n      }\n    }\n\n    function filterLessons(category, element) {\n      const allTabs = document.querySelectorAll(\'.tab\');\n      const cards = document.querySelectorAll(\'.lesson-card\');\n\n      allTabs.forEach(tab => tab.classList.remove(\'active\'));\n      element.classList.add(\'active\');\n\n      cards.forEach(card => {\n        const cardCategory = card.getAttribute(\'data-category\');\n        if (category === \'all\' || cardCategory === category) {\n          card.style.display = \'flex\';\n        } else {\n          card.style.display = \'none\';\n        }\n      });\n    }\n  </script>\n</body>\n</html><?php \nsession_start(); \n\n// Security: Check if user is logged in\nif (!isset($_SESSION[\'user_id\'])) {\n    header(\"Location: login.php\");\n    exit();\n}\n\n// Get user information\n$user_name = $_SESSION[\'full_name\'];\n$user_role = $_SESSION[\'role\'];\n?>\n<!DOCTYPE html>\n<html lang=\"en\">\n<style>\n    body {\n    margin: 0;\n    font-family: \'Segoe UI\', sans-serif;\n    background-color: #2e3f54;\n    color: white;\n    }\n\n    /* Navbar */\n    .navbar {\n    background-color: #111;\n    padding: 1rem 2rem;\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    }\n\n    .logo {\n    color: white;\n    font-weight: bold;\n    font-size: 1.2rem;\n    }\n\n    .nav-links {\n    list-style: none;\n    display: flex;\n    gap: 1.5rem;\n    }\n\n    .nav-links li a {\n    color: white;\n    text-decoration: none;\n    }\n\n    .nav-icons {\n    display: flex;\n    align-items: center;\n    gap: 1rem;\n    }\n\n    .icon {\n    font-size: 1.2rem;\n    }\n\n    .username {\n    font-weight: bold;\n    }\n\n    .logout-btn {\n    background-color: #2e3f54;\n    color: white;\n    border: none;\n    padding: 0.4rem 1rem;\n    border-radius: 5px;\n    cursor: pointer;\n    }\n\n    /* Main content */\n    .browse-container {\n    padding: 2rem;\n    }\n\n    .browse-container h2 {\n    font-size: 2rem;\n    margin-bottom: 1rem;\n    }\n\n    /* Tabs */\n    .tabs {\n    display: flex;\n    gap: 2rem;\n    margin-bottom: 2rem;\n    border-bottom: 2px solid white;\n    padding-bottom: 0.5rem;\n    }\n\n    .tab {\n    background: none;\n    border: none;\n    color: white;\n    font-size: 1rem;\n    padding: 0.5rem;\n    cursor: pointer;\n    position: relative;\n    }\n\n    .tab.active::after {\n    content: \"\";\n    position: absolute;\n    bottom: -2px;\n    left: 0;\n    right: 0;\n    height: 3px;\n    background-color: white;\n    }\n\n    /* Lesson cards */\n    .section-title {\n    margin-top: 2rem;\n    font-size: 1.3rem;\n    }\n\n    .lessons-grid {\n    display: flex;\n    gap: 2rem;\n    flex-wrap: wrap;\n    margin-top: 1rem;\n    }\n\n    .lesson-card {\n    background-color: white;\n    color: black;\n    padding: 1rem;\n    border-radius: 1rem;\n    text-align: center;\n    width: 150px;\n    transition: transform 0.2s;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    }\n\n    .lesson-card img {\n    max-width: 100px;\n    height: auto;\n    margin-bottom: 0.5rem;\n    }\n\n    .lesson-card:hover {\n    transform: scale(1.05);\n    }\n    .logo a {\n      color: white;\n      text-decoration: none;\n    }\n    .logo a:hover {\n    text-decoration: underline;\n    }\n</style>\n<head>\n  <meta charset=\"UTF-8\" />\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"/>\n  <title>Browse lessons and tutorials</title>\n</head>\n<body>\n\n  <!-- Navbar -->\n  <nav class=\"navbar\">\n    <div class=\"logo\">\n        <a href=\"<?php\n            echo ($user_role === \'student\') ? \'studentDashboard.php\' :\n                (($user_role === \'instructor\') ? \'instructorDashboard.php\' : \n                (($user_role === \'admin\') ? \'adminDashboard.php\' : \'#\'));\n        ?>\" style=\"color: white; text-decoration: none;\">\n            Code Lab @ HELP\n        </a>\n    </div>\n    <ul class=\"nav-links\">\n        <li>\n            <a href=\"<?php\n                echo ($user_role === \'student\') ? \'studentDashboard.php\' :\n                    (($user_role === \'instructor\') ? \'instructorDashboard.php\' : \n                    (($user_role === \'admin\') ? \'adminDashboard.php\' : \'#\'));\n            ?>\">Dashboard</a>\n        </li>\n      <li><a href=\"browser.php\">Browse</a></li>\n      <li><a href=\"#\">Reports</a></li>\n      <li><a href=\"#\">Feedback</a></li>\n    </ul>\n    <div class=\"nav-icons\">\n      <span class=\"icon\">üîî</span>\n      <span class=\"icon\">‚öôÔ∏è</span>\n      <span class=\"icon\">üë§</span>\n      <span class=\"username\"><?php echo htmlspecialchars($user_name); ?></span>\n      <button class=\"logout-btn\" onclick=\"confirmLogout()\">Log Out</button>\n    </div>\n  </nav>\n\n  <main class=\"browse-container\">\n    <h2>Browse lessons and tutorials</h2>\n\n    <!-- Filter Tabs -->\n    <div class=\"tabs\">\n      <button class=\"tab active\" onclick=\"filterLessons(\'all\', this)\">All</button>\n      <button class=\"tab\" onclick=\"filterLessons(\'frontend\', this)\">Frontend Development</button>\n      <button class=\"tab\" onclick=\"filterLessons(\'backend\', this)\">Backend Development</button>\n    </div>\n\n    <h3 class=\"section-title\">Newly Added</h3>\n    <div class=\"lessons-grid\">\n        <div class=\"lesson-card\" data-category=\"frontend\" onclick=\"window.location.href=\'exercises.php\'\">\n          <img src=\"https://upload.wikimedia.org/wikipedia/commons/6/61/HTML5_logo_and_wordmark.svg\" alt=\"HTML5\">\n          <p>HTML Lessons</p>\n        </div>\n        <div class=\"lesson-card\" data-category=\"frontend\" onclick=\"window.location.href=\'exercises.php\'\">\n          <img src=\"https://upload.wikimedia.org/wikipedia/commons/d/d5/CSS3_logo_and_wordmark.svg\" alt=\"CSS3\">\n          <p>CSS Lessons</p>\n        </div>\n        <div class=\"lesson-card\" data-category=\"backend\" onclick=\"window.location.href=\'exercises.php\'\">\n          <img src=\"https://upload.wikimedia.org/wikipedia/commons/6/6a/JavaScript-logo.png\" alt=\"JavaScript\">\n          <p>JavaScript Lessons</p>\n        </div>\n      </div>\n    </div>\n  </main>\n\n  <script>\n    function confirmLogout() {\n      if (confirm(\"Are you sure you want to log out?\")) {\n        window.location.href = \'logout.php\';\n      }\n    }\n\n    function filterLessons(category, element) {\n      const allTabs = document.querySelectorAll(\'.tab\');\n      const cards = document.querySelectorAll(\'.lesson-card\');\n\n      allTabs.forEach(tab => tab.classList.remove(\'active\'));\n      element.classList.add(\'active\');\n\n      cards.forEach(card => {\n        const cardCategory = card.getAttribute(\'data-category\');\n        if (category === \'all\' || cardCategory === category) {\n          card.style.display = \'flex\';\n        } else {\n          card.style.display = \'none\';\n        }\n      });\n    }\n  </script>\n</body>\n</html>', 'passed', 10, 'Congratulations! Your solution meets the requirements. Good: Code has substantial implementation. Good: Code includes comments. Good: Code structure detected. ', 3, 3, '2025-10-02 13:01:13'),
(4, 2, 3, '<?php \nsession_start(); \n\n// Security: Check if user is logged in\nif (!isset($_SESSION[\'user_id\'])) {\n    header(\"Location: login.php\");\n    exit();\n}\n\n// Get user information\n$user_name = $_SESSION[\'full_name\'];\n$user_role = $_SESSION[\'role\'];\n?>\n<!DOCTYPE html>\n<html lang=\"en\">\n<style>\n    body {\n    margin: 0;\n    font-family: \'Segoe UI\', sans-serif;\n    background-color: #2e3f54;\n    color: white;\n    }\n\n    /* Navbar */\n    .navbar {\n    background-color: #111;\n    padding: 1rem 2rem;\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    }\n\n    .logo {\n    color: white;\n    font-weight: bold;\n    font-size: 1.2rem;\n    }\n\n    .nav-links {\n    list-style: none;\n    display: flex;\n    gap: 1.5rem;\n    }\n\n    .nav-links li a {\n    color: white;\n    text-decoration: none;\n    }\n\n    .nav-icons {\n    display: flex;\n    align-items: center;\n    gap: 1rem;\n    }\n\n    .icon {\n    font-size: 1.2rem;\n    }\n\n    .username {\n    font-weight: bold;\n    }\n\n    .logout-btn {\n    background-color: #2e3f54;\n    color: white;\n    border: none;\n    padding: 0.4rem 1rem;\n    border-radius: 5px;\n    cursor: pointer;\n    }\n\n    /* Main content */\n    .browse-container {\n    padding: 2rem;\n    }\n\n    .browse-container h2 {\n    font-size: 2rem;\n    margin-bottom: 1rem;\n    }\n\n    /* Tabs */\n    .tabs {\n    display: flex;\n    gap: 2rem;\n    margin-bottom: 2rem;\n    border-bottom: 2px solid white;\n    padding-bottom: 0.5rem;\n    }\n\n    .tab {\n    background: none;\n    border: none;\n    color: white;\n    font-size: 1rem;\n    padding: 0.5rem;\n    cursor: pointer;\n    position: relative;\n    }\n\n    .tab.active::after {\n    content: \"\";\n    position: absolute;\n    bottom: -2px;\n    left: 0;\n    right: 0;\n    height: 3px;\n    background-color: white;\n    }\n\n    /* Lesson cards */\n    .section-title {\n    margin-top: 2rem;\n    font-size: 1.3rem;\n    }\n\n    .lessons-grid {\n    display: flex;\n    gap: 2rem;\n    flex-wrap: wrap;\n    margin-top: 1rem;\n    }\n\n    .lesson-card {\n    background-color: white;\n    color: black;\n    padding: 1rem;\n    border-radius: 1rem;\n    text-align: center;\n    width: 150px;\n    transition: transform 0.2s;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    }\n\n    .lesson-card img {\n    max-width: 100px;\n    height: auto;\n    margin-bottom: 0.5rem;\n    }\n\n    .lesson-card:hover {\n    transform: scale(1.05);\n    }\n    .logo a {\n      color: white;\n      text-decoration: none;\n    }\n    .logo a:hover {\n    text-decoration: underline;\n    }\n</style>\n<head>\n  <meta charset=\"UTF-8\" />\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"/>\n  <title>Browse lessons and tutorials</title>\n</head>\n<body>\n\n  <!-- Navbar -->\n  <nav class=\"navbar\">\n    <div class=\"logo\">\n        <a href=\"<?php\n            echo ($user_role === \'student\') ? \'studentDashboard.php\' :\n                (($user_role === \'instructor\') ? \'instructorDashboard.php\' : \n                (($user_role === \'admin\') ? \'adminDashboard.php\' : \'#\'));\n        ?>\" style=\"color: white; text-decoration: none;\">\n            Code Lab @ HELP\n        </a>\n    </div>\n    <ul class=\"nav-links\">\n        <li>\n            <a href=\"<?php\n                echo ($user_role === \'student\') ? \'studentDashboard.php\' :\n                    (($user_role === \'instructor\') ? \'instructorDashboard.php\' : \n                    (($user_role === \'admin\') ? \'adminDashboard.php\' : \'#\'));\n            ?>\">Dashboard</a>\n        </li>\n      <li><a href=\"browser.php\">Browse</a></li>\n      <li><a href=\"#\">Reports</a></li>\n      <li><a href=\"#\">Feedback</a></li>\n    </ul>\n    <div class=\"nav-icons\">\n      <span class=\"icon\">üîî</span>\n      <span class=\"icon\">‚öôÔ∏è</span>\n      <span class=\"icon\">üë§</span>\n      <span class=\"username\"><?php echo htmlspecialchars($user_name); ?></span>\n      <button class=\"logout-btn\" onclick=\"confirmLogout()\">Log Out</button>\n    </div>\n  </nav>\n\n  <main class=\"browse-container\">\n    <h2>Browse lessons and tutorials</h2>\n\n    <!-- Filter Tabs -->\n    <div class=\"tabs\">\n      <button class=\"tab active\" onclick=\"filterLessons(\'all\', this)\">All</button>\n      <button class=\"tab\" onclick=\"filterLessons(\'frontend\', this)\">Frontend Development</button>\n      <button class=\"tab\" onclick=\"filterLessons(\'backend\', this)\">Backend Development</button>\n    </div>\n\n    <h3 class=\"section-title\">Newly Added</h3>\n    <div class=\"lessons-grid\">\n        <div class=\"lesson-card\" data-category=\"frontend\" onclick=\"window.location.href=\'exercises.php\'\">\n          <img src=\"https://upload.wikimedia.org/wikipedia/commons/6/61/HTML5_logo_and_wordmark.svg\" alt=\"HTML5\">\n          <p>HTML Lessons</p>\n        </div>\n        <div class=\"lesson-card\" data-category=\"frontend\" onclick=\"window.location.href=\'exercises.php\'\">\n          <img src=\"https://upload.wikimedia.org/wikipedia/commons/d/d5/CSS3_logo_and_wordmark.svg\" alt=\"CSS3\">\n          <p>CSS Lessons</p>\n        </div>\n        <div class=\"lesson-card\" data-category=\"backend\" onclick=\"window.location.href=\'exercises.php\'\">\n          <img src=\"https://upload.wikimedia.org/wikipedia/commons/6/6a/JavaScript-logo.png\" alt=\"JavaScript\">\n          <p>JavaScript Lessons</p>\n        </div>\n      </div>\n    </div>\n  </main>\n\n  <script>\n    function confirmLogout() {\n      if (confirm(\"Are you sure you want to log out?\")) {\n        window.location.href = \'logout.php\';\n      }\n    }\n\n    function filterLessons(category, element) {\n      const allTabs = document.querySelectorAll(\'.tab\');\n      const cards = document.querySelectorAll(\'.lesson-card\');\n\n      allTabs.forEach(tab => tab.classList.remove(\'active\'));\n      element.classList.add(\'active\');\n\n      cards.forEach(card => {\n        const cardCategory = card.getAttribute(\'data-category\');\n        if (category === \'all\' || cardCategory === category) {\n          card.style.display = \'flex\';\n        } else {\n          card.style.display = \'none\';\n        }\n      });\n    }\n  </script>\n</body>\n</html>', 'passed', 14, 'Congratulations! Your solution meets the requirements. Good: Code has substantial implementation. Good: Code includes comments. Good: Code structure detected. ', 3, 3, '2025-10-02 13:01:29'),
(5, 1, 3, '<?php \nsession_start(); \n\n// Security: Check if user is logged in\nif (!isset($_SESSION[\'user_id\'])) {\n    header(\"Location: login.php\");\n    exit();\n}\n\n// Get user information\n$user_name = $_SESSION[\'full_name\'];\n$user_role = $_SESSION[\'role\'];\n?>\n<!DOCTYPE html>\n<html lang=\"en\">\n<style>\n    body {\n    margin: 0;\n    font-family: \'Segoe UI\', sans-serif;\n    background-color: #2e3f54;\n    color: white;\n    }\n\n    /* Navbar */\n    .navbar {\n    background-color: #111;\n    padding: 1rem 2rem;\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    }\n\n    .logo {\n    color: white;\n    font-weight: bold;\n    font-size: 1.2rem;\n    }\n\n    .nav-links {\n    list-style: none;\n    display: flex;\n    gap: 1.5rem;\n    }\n\n    .nav-links li a {\n    color: white;\n    text-decoration: none;\n    }\n\n    .nav-icons {\n    display: flex;\n    align-items: center;\n    gap: 1rem;\n    }\n\n    .icon {\n    font-size: 1.2rem;\n    }\n\n    .username {\n    font-weight: bold;\n    }\n\n    .logout-btn {\n    background-color: #2e3f54;\n    color: white;\n    border: none;\n    padding: 0.4rem 1rem;\n    border-radius: 5px;\n    cursor: pointer;\n    }\n\n    /* Main content */\n    .browse-container {\n    padding: 2rem;\n    }\n\n    .browse-container h2 {\n    font-size: 2rem;\n    margin-bottom: 1rem;\n    }\n\n    /* Tabs */\n    .tabs {\n    display: flex;\n    gap: 2rem;\n    margin-bottom: 2rem;\n    border-bottom: 2px solid white;\n    padding-bottom: 0.5rem;\n    }\n\n    .tab {\n    background: none;\n    border: none;\n    color: white;\n    font-size: 1rem;\n    padding: 0.5rem;\n    cursor: pointer;\n    position: relative;\n    }\n\n    .tab.active::after {\n    content: \"\";\n    position: absolute;\n    bottom: -2px;\n    left: 0;\n    right: 0;\n    height: 3px;\n    background-color: white;\n    }\n\n    /* Lesson cards */\n    .section-title {\n    margin-top: 2rem;\n    font-size: 1.3rem;\n    }\n\n    .lessons-grid {\n    display: flex;\n    gap: 2rem;\n    flex-wrap: wrap;\n    margin-top: 1rem;\n    }\n\n    .lesson-card {\n    background-color: white;\n    color: black;\n    padding: 1rem;\n    border-radius: 1rem;\n    text-align: center;\n    width: 150px;\n    transition: transform 0.2s;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    }\n\n    .lesson-card img {\n    max-width: 100px;\n    height: auto;\n    margin-bottom: 0.5rem;\n    }\n\n    .lesson-card:hover {\n    transform: scale(1.05);\n    }\n    .logo a {\n      color: white;\n      text-decoration: none;\n    }\n    .logo a:hover {\n    text-decoration: underline;\n    }\n</style>\n<head>\n  <meta charset=\"UTF-8\" />\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"/>\n  <title>Browse lessons and tutorials</title>\n</head>\n<body>\n\n  <!-- Navbar -->\n  <nav class=\"navbar\">\n    <div class=\"logo\">\n        <a href=\"<?php\n            echo ($user_role === \'student\') ? \'studentDashboard.php\' :\n                (($user_role === \'instructor\') ? \'instructorDashboard.php\' : \n                (($user_role === \'admin\') ? \'adminDashboard.php\' : \'#\'));\n        ?>\" style=\"color: white; text-decoration: none;\">\n            Code Lab @ HELP\n        </a>\n    </div>\n    <ul class=\"nav-links\">\n        <li>\n            <a href=\"<?php\n                echo ($user_role === \'student\') ? \'studentDashboard.php\' :\n                    (($user_role === \'instructor\') ? \'instructorDashboard.php\' : \n                    (($user_role === \'admin\') ? \'adminDashboard.php\' : \'#\'));\n            ?>\">Dashboard</a>\n        </li>\n      <li><a href=\"browser.php\">Browse</a></li>\n      <li><a href=\"#\">Reports</a></li>\n      <li><a href=\"#\">Feedback</a></li>\n    </ul>\n    <div class=\"nav-icons\">\n      <span class=\"icon\">üîî</span>\n      <span class=\"icon\">‚öôÔ∏è</span>\n      <span class=\"icon\">üë§</span>\n      <span class=\"username\"><?php echo htmlspecialchars($user_name); ?></span>\n      <button class=\"logout-btn\" onclick=\"confirmLogout()\">Log Out</button>\n    </div>\n  </nav>\n\n  <main class=\"browse-container\">\n    <h2>Browse lessons and tutorials</h2>\n\n    <!-- Filter Tabs -->\n    <div class=\"tabs\">\n      <button class=\"tab active\" onclick=\"filterLessons(\'all\', this)\">All</button>\n      <button class=\"tab\" onclick=\"filterLessons(\'frontend\', this)\">Frontend Development</button>\n      <button class=\"tab\" onclick=\"filterLessons(\'backend\', this)\">Backend Development</button>\n    </div>\n\n    <h3 class=\"section-title\">Newly Added</h3>\n    <div class=\"lessons-grid\">\n        <div class=\"lesson-card\" data-category=\"frontend\" onclick=\"window.location.href=\'exercises.php\'\">\n          <img src=\"https://upload.wikimedia.org/wikipedia/commons/6/61/HTML5_logo_and_wordmark.svg\" alt=\"HTML5\">\n          <p>HTML Lessons</p>\n        </div>\n        <div class=\"lesson-card\" data-category=\"frontend\" onclick=\"window.location.href=\'exercises.php\'\">\n          <img src=\"https://upload.wikimedia.org/wikipedia/commons/d/d5/CSS3_logo_and_wordmark.svg\" alt=\"CSS3\">\n          <p>CSS Lessons</p>\n        </div>\n        <div class=\"lesson-card\" data-category=\"backend\" onclick=\"window.location.href=\'exercises.php\'\">\n          <img src=\"https://upload.wikimedia.org/wikipedia/commons/6/6a/JavaScript-logo.png\" alt=\"JavaScript\">\n          <p>JavaScript Lessons</p>\n        </div>\n      </div>\n    </div>\n  </main>\n\n  <script>\n    function confirmLogout() {\n      if (confirm(\"Are you sure you want to log out?\")) {\n        window.location.href = \'logout.php\';\n      }\n    }\n\n    function filterLessons(category, element) {\n      const allTabs = document.querySelectorAll(\'.tab\');\n      const cards = document.querySelectorAll(\'.lesson-card\');\n\n      allTabs.forEach(tab => tab.classList.remove(\'active\'));\n      element.classList.add(\'active\');\n\n      cards.forEach(card => {\n        const cardCategory = card.getAttribute(\'data-category\');\n        if (category === \'all\' || cardCategory === category) {\n          card.style.display = \'flex\';\n        } else {\n          card.style.display = \'none\';\n        }\n      });\n    }\n  </script>\n</body>\n</html>', 'passed', 10, 'Congratulations! Your solution meets the requirements. Good: Code has substantial implementation. Good: Code includes comments. Good: Code structure detected. ', 3, 3, '2025-10-02 13:01:39'),
(7, 1, 5, '<?php\nsession_start();\ninclude \'db_connect.php\';\n\n// Check if user is student\nif (!isset($_SESSION[\'user_id\']) || $_SESSION[\'role\'] !== \'student\') {\n    header(\"Location: login.php\");\n    exit();\n}\n\n$student_id = $_SESSION[\'user_id\'];\n$student_name = $_SESSION[\'full_name\'];\n\n// Get all submissions with feedback\n$submissions_query = \"\n    SELECT \n        es.*,\n        e.title as exercise_title,\n        e.points as max_points,\n        l.title as lesson_title,\n        l.category,\n        (SELECT COUNT(*) FROM instructor_feedback if2 WHERE if2.submission_id = es.id) as feedback_count,\n        (SELECT MAX(if3.created_at) FROM instructor_feedback if3 WHERE if3.submission_id = es.id) as last_feedback_date\n    FROM exercise_submissions es\n    JOIN exercises e ON e.id = es.exercise_id\n    JOIN lessons l ON l.id = e.lesson_id\n    WHERE es.student_id = ?\n    ORDER BY es.submitted_at DESC\n\";\n\n$stmt = $conn->prepare($submissions_query);\n$stmt->bind_param(\"i\", $student_id);\n$stmt->execute();\n$submissions = $stmt->get_result();\n\n// Count feedback\n$total_feedback_count = 0;\n$new_feedback_count = 0;\n$submissions_array = [];\n\nwhile ($row = $submissions->fetch_assoc()) {\n    $total_feedback_count += $row[\'feedback_count\'];\n    $submissions_array[] = $row;\n}\n?>\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>My Feedback - Code Lab @ HELP</title>\n    <style>\n        * {\n            margin: 0;\n            padding: 0;\n            box-sizing: border-box;\n        }\n\n        body {\n            font-family: \'Segoe UI\', sans-serif;\n            background-color: #2e3f54;\n            color: white;\n        }\n\n        .navbar {\n            background-color: #111;\n            padding: 1rem 2rem;\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n        }\n\n        .logo { color: white; font-weight: bold; font-size: 1.2rem; }\n        .nav-links { list-style: none; display: flex; gap: 1.5rem; }\n        .nav-links li a { color: white; text-decoration: none; }\n        .nav-icons { display: flex; align-items: center; gap: 1rem; }\n        \n        .logout-btn {\n            background-color: #2e3f54;\n            color: white;\n            border: none;\n            padding: 0.4rem 1rem;\n            border-radius: 5px;\n            cursor: pointer;\n        }\n\n        .container {\n            max-width: 1400px;\n            margin: 0 auto;\n            padding: 2rem;\n        }\n\n        .page-header {\n            margin-bottom: 2rem;\n        }\n\n        .page-header h1 {\n            font-size: 2rem;\n            margin-bottom: 0.5rem;\n        }\n\n        .stats-card {\n            background-color: #1a2332;\n            padding: 2rem;\n            border-radius: 12px;\n            text-align: center;\n            margin-bottom: 2rem;\n        }\n\n        .stat-value {\n            font-size: 3rem;\n            font-weight: bold;\n            color: #358efb;\n        }\n\n        .stat-label {\n            color: #aaa;\n            margin-top: 0.5rem;\n            font-size: 1.1rem;\n        }\n\n        .submissions-grid {\n            display: grid;\n            gap: 1.5rem;\n        }\n\n        .submission-card {\n            background-color: #1a2332;\n            padding: 1.5rem;\n            border-radius: 12px;\n            border-left: 4px solid #358efb;\n            transition: all 0.2s;\n        }\n\n        .submission-card:hover {\n            background-color: #1f2a3a;\n            transform: translateY(-2px);\n        }\n\n        .submission-card.has-feedback {\n            border-left-color: #4caf50;\n        }\n\n        .submission-header {\n            display: flex;\n            justify-content: space-between;\n            align-items: start;\n            margin-bottom: 1rem;\n        }\n\n        .submission-title {\n            font-size: 1.2rem;\n            font-weight: bold;\n            color: #358efb;\n        }\n\n        .feedback-badge {\n            background-color: #4caf50;\n            color: white;\n            padding: 0.4rem 0.8rem;\n            border-radius: 20px;\n            font-size: 0.9rem;\n            font-weight: bold;\n        }\n\n        .submission-meta {\n            display: flex;\n            gap: 2rem;\n            margin: 1rem 0;\n            color: #aaa;\n            font-size: 0.9rem;\n        }\n\n        .status-badge {\n            padding: 0.3rem 0.8rem;\n            border-radius: 20px;\n            font-size: 0.85rem;\n            font-weight: bold;\n        }\n\n        .status-passed { background-color: #4caf50; color: white; }\n        .status-failed { background-color: #f44336; color: white; }\n        .status-pending { background-color: #ff9800; color: white; }\n\n        .btn-view {\n            padding: 0.6rem 1.2rem;\n            background-color: #358efb;\n            color: white;\n            border: none;\n            border-radius: 8px;\n            cursor: pointer;\n            font-weight: bold;\n            margin-top: 1rem;\n        }\n\n        .btn-view:hover {\n            background-color: #2a72c9;\n        }\n\n        /* Modal */\n        .modal {\n            display: none;\n            position: fixed;\n            top: 0;\n            left: 0;\n            width: 100%;\n            height: 100%;\n            background-color: rgba(0,0,0,0.8);\n            z-index: 1000;\n            overflow-y: auto;\n        }\n\n        .modal.active {\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            padding: 2rem;\n        }\n\n        .modal-content {\n            background-color: #1a2332;\n            padding: 2rem;\n            border-radius: 12px;\n            max-width: 900px;\n            width: 100%;\n            max-height: 90vh;\n            overflow-y: auto;\n        }\n\n        .modal-header {\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            margin-bottom: 1.5rem;\n            padding-bottom: 1rem;\n            border-bottom: 2px solid #2e3f54;\n        }\n\n        .close-btn {\n            background: none;\n            border: none;\n            color: white;\n            font-size: 2rem;\n            cursor: pointer;\n        }\n\n        .section-title {\n            font-size: 1.3rem;\n            font-weight: bold;\n            margin: 1.5rem 0 1rem;\n            color: #358efb;\n        }\n\n        .code-viewer {\n            background-color: #1e1e1e;\n            padding: 1.5rem;\n            border-radius: 8px;\n            margin: 1rem 0;\n            overflow-x: auto;\n        }\n\n        .code-viewer pre {\n            color: #d4d4d4;\n            font-family: \'Courier New\', monospace;\n            font-size: 14px;\n            white-space: pre-wrap;\n        }\n\n        .feedback-item {\n            background-color: #2e3f54;\n            padding: 1.5rem;\n            border-radius: 8px;\n            margin-bottom: 1rem;\n            border-left: 4px solid #4caf50;\n        }\n\n        .feedback-header {\n            display: flex;\n            justify-content: space-between;\n            margin-bottom: 1rem;\n            color: #aaa;\n        }\n\n        .feedback-text {\n            color: white;\n            line-height: 1.6;\n            margin-bottom: 1rem;\n        }\n\n        .manual-grade {\n            background-color: #4caf50;\n            color: white;\n            padding: 0.5rem 1rem;\n            border-radius: 8px;\n            display: inline-block;\n        }\n\n        .empty-state {\n            background-color: #1a2332;\n            padding: 3rem;\n            border-radius: 12px;\n            text-align: center;\n            color: #888;\n        }\n\n        .empty-state h3 {\n            margin-bottom: 1rem;\n        }\n\n        .detail-row {\n            display: flex;\n            justify-content: space-between;\n            padding: 0.5rem 0;\n            border-bottom: 1px solid #2e3f54;\n        }\n\n        .detail-label {\n            color: #aaa;\n            font-weight: bold;\n        }\n    </style>\n</head>\n<body>\n    <nav class=\"navbar\">\n        <div class=\"logo\">Code Lab @ HELP</div>\n        <ul class=\"nav-links\">\n            <li><a href=\"studentDashboard.php\">Dashboard</a></li>\n            <li><a href=\"browser.php\">Browse</a></li>\n            <li><a href=\"exercises.php\">Exercises</a></li>\n            <li><a href=\"my_assignments.php\">My Assignments</a></li>\n            <li><a href=\"progress.php\">Progress</a></li>\n            <li><a href=\"my_feedback.php\">My Feedback</a></li>\n        </ul>\n        <div class=\"nav-icons\">\n            <span><?php echo htmlspecialchars($student_name); ?></span>\n            <button class=\"logout-btn\" onclick=\"confirmLogout()\">Log Out</button>\n        </div>\n    </nav>\n\n    <div class=\"container\">\n        <div class=\"page-header\">\n            <h1>My Instructor Feedback</h1>\n            <p style=\"color: #aaa;\">Review personalized feedback from your instructors</p>\n        </div>\n\n        <div class=\"stats-card\">\n            <div class=\"stat-value\"><?php echo $total_feedback_count; ?></div>\n            <div class=\"stat-label\">Total Feedback Received</div>\n        </div>\n\n        <div class=\"submissions-grid\">\n            <?php if (count($submissions_array) > 0): ?>\n                <?php foreach ($submissions_array as $submission): ?>\n                    <div class=\"submission-card <?php echo $submission[\'feedback_count\'] > 0 ? \'has-feedback\' : \'\'; ?>\">\n                        <div class=\"submission-header\">\n                            <div>\n                                <div class=\"submission-title\"><?php echo htmlspecialchars($submission[\'exercise_title\']); ?></div>\n                                <div style=\"color: #aaa; margin-top: 0.3rem;\">\n                                    <?php echo htmlspecialchars($submission[\'lesson_title\']); ?>\n                                </div>\n                            </div>\n                            <?php if ($submission[\'feedback_count\'] > 0): ?>\n                                <span class=\"feedback-badge\">\n                                    <?php echo $submission[\'feedback_count\']; ?> Feedback(s)\n                                </span>\n                            <?php endif; ?>\n                        </div>\n\n                        <div class=\"submission-meta\">\n                            <span>\n                                <span class=\"status-badge status-<?php echo $submission[\'status\']; ?>\">\n                                    <?php echo strtoupper($submission[\'status\']); ?>\n                                </span>\n                            </span>\n                            <span>Score: <strong><?php echo $submission[\'score\']; ?></strong> / <?php echo $submission[\'max_points\']; ?></span>\n                            <span>Submitted: <?php echo date(\'M j, Y g:i A\', strtotime($submission[\'submitted_at\'])); ?></span>\n                        </div>\n\n                        <?php if ($submission[\'feedback_count\'] > 0): ?>\n                            <div style=\"color: #4caf50; margin-top: 0.5rem;\">\n                                ‚úì Last feedback: <?php echo date(\'M j, g:i A\', strtotime($submission[\'last_feedback_date\'])); ?>\n                            </div>\n                        <?php endif; ?>\n\n                        <button class=\"btn-view\" onclick=\"viewFeedback(<?php echo $submission[\'id\']; ?>, <?php echo json_encode($submission); ?>)\">\n                            View Code & Feedback\n                        </button>\n                    </div>\n                <?php endforeach; ?>\n            <?php else: ?>\n                <div class=\"empty-state\">\n                    <h3>No submissions yet</h3>\n                    <p>Complete some exercises to receive instructor feedback!</p>\n                    <a href=\"exercises.php\" style=\"color: #358efb; text-decoration: none; font-weight: bold; margin-top: 1rem; display: inline-block;\">\n                        Go to Exercises ‚Üí\n                    </a>\n                </div>\n            <?php endif; ?>\n        </div>\n    </div>\n\n    <!-- Feedback Modal -->\n    <div class=\"modal\" id=\"feedbackModal\">\n        <div class=\"modal-content\">\n            <div class=\"modal-header\">\n                <h2>Submission & Feedback Details</h2>\n                <button class=\"close-btn\" onclick=\"closeModal()\">&times;</button>\n            </div>\n            <div id=\"modalBody\"></div>\n        </div>\n    </div>\n\n    <script>\n        function confirmLogout() {\n            if (confirm(\"Are you sure you want to log out?\")) {\n                window.location.href = \'logout.php\';\n            }\n        }\n\n        function viewFeedback(submissionId, submission) {\n            const modal = document.getElementById(\'feedbackModal\');\n            const modalBody = document.getElementById(\'modalBody\');\n\n            // Fetch feedback\n            fetch(`get_feedback.php?submission_id=${submissionId}`)\n                .then(response => response.json())\n                .then(data => {\n                    let feedbackHtml = \'\';\n                    \n                    if (data.success && data.feedback.length > 0) {\n                        feedbackHtml = \'<div class=\"section-title\">Instructor Feedback</div>\';\n                        data.feedback.forEach(fb => {\n                            const fbDate = new Date(fb.created_at).toLocaleString();\n                            feedbackHtml += `\n                                <div class=\"feedback-item\">\n                                    <div class=\"feedback-header\">\n                                        <span><strong>From: ${fb.instructor_name}</strong></span>\n                                        <span>${fbDate}</span>\n                                    </div>\n                                    <div class=\"feedback-text\">${escapeHtml(fb.feedback)}</div>\n                                    ${fb.grade !== null ? `\n                                        <div class=\"manual-grade\">\n                                            ‚≠ê Manual Grade: ${fb.grade} / ${submission.max_points}\n                                        </div>\n                                    ` : \'\'}\n                                </div>\n                            `;\n                        });\n                    } else {\n                        feedbackHtml = `\n                            <div style=\"text-align: center; padding: 2rem; color: #888;\">\n                                <h3>No instructor feedback yet</h3>\n                                <p>Your instructor hasn\'t provided feedback for this submission.</p>\n                            </div>\n                        `;\n                    }\n\n                    const statusClass = \'status-\' + submission.status;\n\n                    modalBody.innerHTML = `\n                        <div style=\"background-color: #2e3f54; padding: 1.5rem; border-radius: 8px; margin-bottom: 1.5rem;\">\n                            <div class=\"detail-row\">\n                                <span class=\"detail-label\">Exercise:</span>\n                                <span>${submission.exercise_title}</span>\n                            </div>\n                            <div class=\"detail-row\">\n                                <span class=\"detail-label\">Lesson:</span>\n                                <span>${submission.lesson_title}</span>\n                            </div>\n                            <div class=\"detail-row\">\n                                <span class=\"detail-label\">Status:</span>\n                                <span class=\"status-badge ${statusClass}\">${submission.status.toUpperCase()}</span>\n                            </div>\n                            <div class=\"detail-row\">\n                                <span class=\"detail-label\">Your Score:</span>\n                                <span><strong>${submission.score} / ${submission.max_points}</strong></span>\n                            </div>\n                            <div class=\"detail-row\">\n                                <span class=\"detail-label\">Submitted:</span>\n                                <span>${new Date(submission.submitted_at).toLocaleString()}</span>\n                            </div>\n                        </div>\n\n                        ${feedbackHtml}\n\n                        <div class=\"section-title\">Your Submitted Code</div>\n                        <div class=\"code-viewer\">\n                            <pre>${escapeHtml(submission.submitted_code)}</pre>\n                        </div>\n\n                        ${submission.feedback ? `\n                            <div class=\"section-title\">Auto-Generated Feedback</div>\n                            <div style=\"background-color: #2e3f54; padding: 1rem; border-radius: 8px;\">\n                                ${escapeHtml(submission.feedback)}\n                            </div>\n                        ` : \'\'}\n                    `;\n\n                    modal.classList.add(\'active\');\n                })\n                .catch(error => {\n                    console.error(\'Error:\', error);\n                    alert(\'Failed to load feedback\');\n                });\n        }\n\n        function closeModal() {\n            document.getElementById(\'feedbackModal\').classList.remove(\'active\');\n        }\n\n        function escapeHtml(text) {\n            const div = document.createElement(\'div\');\n            div.textContent = text;\n            return div.innerHTML;\n        }\n\n        window.onclick = function(event) {\n            const modal = document.getElementById(\'feedbackModal\');\n            if (event.target === modal) {\n                closeModal();\n            }\n        }\n    </script>\n</body>\n</html>', 'passed', 10, 'Congratulations! Your solution meets the requirements. Good: Code has substantial implementation. Good: Code includes comments. Good: Code structure detected. ', 3, 3, '2025-10-11 16:02:56');
INSERT INTO `exercise_submissions` (`id`, `exercise_id`, `student_id`, `submitted_code`, `status`, `score`, `feedback`, `passed_tests`, `total_tests`, `submitted_at`) VALUES
(8, 1, 5, '<?php\nsession_start();\ninclude \'db_connect.php\';\n\n// Check if user is student\nif (!isset($_SESSION[\'user_id\']) || $_SESSION[\'role\'] !== \'student\') {\n    header(\"Location: login.php\");\n    exit();\n}\n\n$student_id = $_SESSION[\'user_id\'];\n$student_name = $_SESSION[\'full_name\'];\n\n// Get all submissions with feedback\n$submissions_query = \"\n    SELECT \n        es.*,\n        e.title as exercise_title,\n        e.points as max_points,\n        l.title as lesson_title,\n        l.category,\n        (SELECT COUNT(*) FROM instructor_feedback if2 WHERE if2.submission_id = es.id) as feedback_count,\n        (SELECT MAX(if3.created_at) FROM instructor_feedback if3 WHERE if3.submission_id = es.id) as last_feedback_date\n    FROM exercise_submissions es\n    JOIN exercises e ON e.id = es.exercise_id\n    JOIN lessons l ON l.id = e.lesson_id\n    WHERE es.student_id = ?\n    ORDER BY es.submitted_at DESC\n\";\n\n$stmt = $conn->prepare($submissions_query);\n$stmt->bind_param(\"i\", $student_id);\n$stmt->execute();\n$submissions = $stmt->get_result();\n\n// Count feedback\n$total_feedback_count = 0;\n$new_feedback_count = 0;\n$submissions_array = [];\n\nwhile ($row = $submissions->fetch_assoc()) {\n    $total_feedback_count += $row[\'feedback_count\'];\n    $submissions_array[] = $row;\n}\n?>\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>My Feedback - Code Lab @ HELP</title>\n    <style>\n        * {\n            margin: 0;\n            padding: 0;\n            box-sizing: border-box;\n        }\n\n        body {\n            font-family: \'Segoe UI\', sans-serif;\n            background-color: #2e3f54;\n            color: white;\n        }\n\n        .navbar {\n            background-color: #111;\n            padding: 1rem 2rem;\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n        }\n\n        .logo { color: white; font-weight: bold; font-size: 1.2rem; }\n        .nav-links { list-style: none; display: flex; gap: 1.5rem; }\n        .nav-links li a { color: white; text-decoration: none; }\n        .nav-icons { display: flex; align-items: center; gap: 1rem; }\n        \n        .logout-btn {\n            background-color: #2e3f54;\n            color: white;\n            border: none;\n            padding: 0.4rem 1rem;\n            border-radius: 5px;\n            cursor: pointer;\n        }\n\n        .container {\n            max-width: 1400px;\n            margin: 0 auto;\n            padding: 2rem;\n        }\n\n        .page-header {\n            margin-bottom: 2rem;\n        }\n\n        .page-header h1 {\n            font-size: 2rem;\n            margin-bottom: 0.5rem;\n        }\n\n        .stats-card {\n            background-color: #1a2332;\n            padding: 2rem;\n            border-radius: 12px;\n            text-align: center;\n            margin-bottom: 2rem;\n        }\n\n        .stat-value {\n            font-size: 3rem;\n            font-weight: bold;\n            color: #358efb;\n        }\n\n        .stat-label {\n            color: #aaa;\n            margin-top: 0.5rem;\n            font-size: 1.1rem;\n        }\n\n        .submissions-grid {\n            display: grid;\n            gap: 1.5rem;\n        }\n\n        .submission-card {\n            background-color: #1a2332;\n            padding: 1.5rem;\n            border-radius: 12px;\n            border-left: 4px solid #358efb;\n            transition: all 0.2s;\n        }\n\n        .submission-card:hover {\n            background-color: #1f2a3a;\n            transform: translateY(-2px);\n        }\n\n        .submission-card.has-feedback {\n            border-left-color: #4caf50;\n        }\n\n        .submission-header {\n            display: flex;\n            justify-content: space-between;\n            align-items: start;\n            margin-bottom: 1rem;\n        }\n\n        .submission-title {\n            font-size: 1.2rem;\n            font-weight: bold;\n            color: #358efb;\n        }\n\n        .feedback-badge {\n            background-color: #4caf50;\n            color: white;\n            padding: 0.4rem 0.8rem;\n            border-radius: 20px;\n            font-size: 0.9rem;\n            font-weight: bold;\n        }\n\n        .submission-meta {\n            display: flex;\n            gap: 2rem;\n            margin: 1rem 0;\n            color: #aaa;\n            font-size: 0.9rem;\n        }\n\n        .status-badge {\n            padding: 0.3rem 0.8rem;\n            border-radius: 20px;\n            font-size: 0.85rem;\n            font-weight: bold;\n        }\n\n        .status-passed { background-color: #4caf50; color: white; }\n        .status-failed { background-color: #f44336; color: white; }\n        .status-pending { background-color: #ff9800; color: white; }\n\n        .btn-view {\n            padding: 0.6rem 1.2rem;\n            background-color: #358efb;\n            color: white;\n            border: none;\n            border-radius: 8px;\n            cursor: pointer;\n            font-weight: bold;\n            margin-top: 1rem;\n        }\n\n        .btn-view:hover {\n            background-color: #2a72c9;\n        }\n\n        /* Modal */\n        .modal {\n            display: none;\n            position: fixed;\n            top: 0;\n            left: 0;\n            width: 100%;\n            height: 100%;\n            background-color: rgba(0,0,0,0.8);\n            z-index: 1000;\n            overflow-y: auto;\n        }\n\n        .modal.active {\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            padding: 2rem;\n        }\n\n        .modal-content {\n            background-color: #1a2332;\n            padding: 2rem;\n            border-radius: 12px;\n            max-width: 900px;\n            width: 100%;\n            max-height: 90vh;\n            overflow-y: auto;\n        }\n\n        .modal-header {\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            margin-bottom: 1.5rem;\n            padding-bottom: 1rem;\n            border-bottom: 2px solid #2e3f54;\n        }\n\n        .close-btn {\n            background: none;\n            border: none;\n            color: white;\n            font-size: 2rem;\n            cursor: pointer;\n        }\n\n        .section-title {\n            font-size: 1.3rem;\n            font-weight: bold;\n            margin: 1.5rem 0 1rem;\n            color: #358efb;\n        }\n\n        .code-viewer {\n            background-color: #1e1e1e;\n            padding: 1.5rem;\n            border-radius: 8px;\n            margin: 1rem 0;\n            overflow-x: auto;\n        }\n\n        .code-viewer pre {\n            color: #d4d4d4;\n            font-family: \'Courier New\', monospace;\n            font-size: 14px;\n            white-space: pre-wrap;\n        }\n\n        .feedback-item {\n            background-color: #2e3f54;\n            padding: 1.5rem;\n            border-radius: 8px;\n            margin-bottom: 1rem;\n            border-left: 4px solid #4caf50;\n        }\n\n        .feedback-header {\n            display: flex;\n            justify-content: space-between;\n            margin-bottom: 1rem;\n            color: #aaa;\n        }\n\n        .feedback-text {\n            color: white;\n            line-height: 1.6;\n            margin-bottom: 1rem;\n        }\n\n        .manual-grade {\n            background-color: #4caf50;\n            color: white;\n            padding: 0.5rem 1rem;\n            border-radius: 8px;\n            display: inline-block;\n        }\n\n        .empty-state {\n            background-color: #1a2332;\n            padding: 3rem;\n            border-radius: 12px;\n            text-align: center;\n            color: #888;\n        }\n\n        .empty-state h3 {\n            margin-bottom: 1rem;\n        }\n\n        .detail-row {\n            display: flex;\n            justify-content: space-between;\n            padding: 0.5rem 0;\n            border-bottom: 1px solid #2e3f54;\n        }\n\n        .detail-label {\n            color: #aaa;\n            font-weight: bold;\n        }\n    </style>\n</head>\n<body>\n    <nav class=\"navbar\">\n        <div class=\"logo\">Code Lab @ HELP</div>\n        <ul class=\"nav-links\">\n            <li><a href=\"studentDashboard.php\">Dashboard</a></li>\n            <li><a href=\"browser.php\">Browse</a></li>\n            <li><a href=\"exercises.php\">Exercises</a></li>\n            <li><a href=\"my_assignments.php\">My Assignments</a></li>\n            <li><a href=\"progress.php\">Progress</a></li>\n            <li><a href=\"my_feedback.php\">My Feedback</a></li>\n        </ul>\n        <div class=\"nav-icons\">\n            <span><?php echo htmlspecialchars($student_name); ?></span>\n            <button class=\"logout-btn\" onclick=\"confirmLogout()\">Log Out</button>\n        </div>\n    </nav>\n\n    <div class=\"container\">\n        <div class=\"page-header\">\n            <h1>My Instructor Feedback</h1>\n            <p style=\"color: #aaa;\">Review personalized feedback from your instructors</p>\n        </div>\n\n        <div class=\"stats-card\">\n            <div class=\"stat-value\"><?php echo $total_feedback_count; ?></div>\n            <div class=\"stat-label\">Total Feedback Received</div>\n        </div>\n\n        <div class=\"submissions-grid\">\n            <?php if (count($submissions_array) > 0): ?>\n                <?php foreach ($submissions_array as $submission): ?>\n                    <div class=\"submission-card <?php echo $submission[\'feedback_count\'] > 0 ? \'has-feedback\' : \'\'; ?>\">\n                        <div class=\"submission-header\">\n                            <div>\n                                <div class=\"submission-title\"><?php echo htmlspecialchars($submission[\'exercise_title\']); ?></div>\n                                <div style=\"color: #aaa; margin-top: 0.3rem;\">\n                                    <?php echo htmlspecialchars($submission[\'lesson_title\']); ?>\n                                </div>\n                            </div>\n                            <?php if ($submission[\'feedback_count\'] > 0): ?>\n                                <span class=\"feedback-badge\">\n                                    <?php echo $submission[\'feedback_count\']; ?> Feedback(s)\n                                </span>\n                            <?php endif; ?>\n                        </div>\n\n                        <div class=\"submission-meta\">\n                            <span>\n                                <span class=\"status-badge status-<?php echo $submission[\'status\']; ?>\">\n                                    <?php echo strtoupper($submission[\'status\']); ?>\n                                </span>\n                            </span>\n                            <span>Score: <strong><?php echo $submission[\'score\']; ?></strong> / <?php echo $submission[\'max_points\']; ?></span>\n                            <span>Submitted: <?php echo date(\'M j, Y g:i A\', strtotime($submission[\'submitted_at\'])); ?></span>\n                        </div>\n\n                        <?php if ($submission[\'feedback_count\'] > 0): ?>\n                            <div style=\"color: #4caf50; margin-top: 0.5rem;\">\n                                ‚úì Last feedback: <?php echo date(\'M j, g:i A\', strtotime($submission[\'last_feedback_date\'])); ?>\n                            </div>\n                        <?php endif; ?>\n\n                        <button class=\"btn-view\" onclick=\"viewFeedback(<?php echo $submission[\'id\']; ?>, <?php echo json_encode($submission); ?>)\">\n                            View Code & Feedback\n                        </button>\n                    </div>\n                <?php endforeach; ?>\n            <?php else: ?>\n                <div class=\"empty-state\">\n                    <h3>No submissions yet</h3>\n                    <p>Complete some exercises to receive instructor feedback!</p>\n                    <a href=\"exercises.php\" style=\"color: #358efb; text-decoration: none; font-weight: bold; margin-top: 1rem; display: inline-block;\">\n                        Go to Exercises ‚Üí\n                    </a>\n                </div>\n            <?php endif; ?>\n        </div>\n    </div>\n\n    <!-- Feedback Modal -->\n    <div class=\"modal\" id=\"feedbackModal\">\n        <div class=\"modal-content\">\n            <div class=\"modal-header\">\n                <h2>Submission & Feedback Details</h2>\n                <button class=\"close-btn\" onclick=\"closeModal()\">&times;</button>\n            </div>\n            <div id=\"modalBody\"></div>\n        </div>\n    </div>\n\n    <script>\n        function confirmLogout() {\n            if (confirm(\"Are you sure you want to log out?\")) {\n                window.location.href = \'logout.php\';\n            }\n        }\n\n        function viewFeedback(submissionId, submission) {\n            const modal = document.getElementById(\'feedbackModal\');\n            const modalBody = document.getElementById(\'modalBody\');\n\n            // Fetch feedback\n            fetch(`get_feedback.php?submission_id=${submissionId}`)\n                .then(response => response.json())\n                .then(data => {\n                    let feedbackHtml = \'\';\n                    \n                    if (data.success && data.feedback.length > 0) {\n                        feedbackHtml = \'<div class=\"section-title\">Instructor Feedback</div>\';\n                        data.feedback.forEach(fb => {\n                            const fbDate = new Date(fb.created_at).toLocaleString();\n                            feedbackHtml += `\n                                <div class=\"feedback-item\">\n                                    <div class=\"feedback-header\">\n                                        <span><strong>From: ${fb.instructor_name}</strong></span>\n                                        <span>${fbDate}</span>\n                                    </div>\n                                    <div class=\"feedback-text\">${escapeHtml(fb.feedback)}</div>\n                                    ${fb.grade !== null ? `\n                                        <div class=\"manual-grade\">\n                                            ‚≠ê Manual Grade: ${fb.grade} / ${submission.max_points}\n                                        </div>\n                                    ` : \'\'}\n                                </div>\n                            `;\n                        });\n                    } else {\n                        feedbackHtml = `\n                            <div style=\"text-align: center; padding: 2rem; color: #888;\">\n                                <h3>No instructor feedback yet</h3>\n                                <p>Your instructor hasn\'t provided feedback for this submission.</p>\n                            </div>\n                        `;\n                    }\n\n                    const statusClass = \'status-\' + submission.status;\n\n                    modalBody.innerHTML = `\n                        <div style=\"background-color: #2e3f54; padding: 1.5rem; border-radius: 8px; margin-bottom: 1.5rem;\">\n                            <div class=\"detail-row\">\n                                <span class=\"detail-label\">Exercise:</span>\n                                <span>${submission.exercise_title}</span>\n                            </div>\n                            <div class=\"detail-row\">\n                                <span class=\"detail-label\">Lesson:</span>\n                                <span>${submission.lesson_title}</span>\n                            </div>\n                            <div class=\"detail-row\">\n                                <span class=\"detail-label\">Status:</span>\n                                <span class=\"status-badge ${statusClass}\">${submission.status.toUpperCase()}</span>\n                            </div>\n                            <div class=\"detail-row\">\n                                <span class=\"detail-label\">Your Score:</span>\n                                <span><strong>${submission.score} / ${submission.max_points}</strong></span>\n                            </div>\n                            <div class=\"detail-row\">\n                                <span class=\"detail-label\">Submitted:</span>\n                                <span>${new Date(submission.submitted_at).toLocaleString()}</span>\n                            </div>\n                        </div>\n\n                        ${feedbackHtml}\n\n                        <div class=\"section-title\">Your Submitted Code</div>\n                        <div class=\"code-viewer\">\n                            <pre>${escapeHtml(submission.submitted_code)}</pre>\n                        </div>\n\n                        ${submission.feedback ? `\n                            <div class=\"section-title\">Auto-Generated Feedback</div>\n                            <div style=\"background-color: #2e3f54; padding: 1rem; border-radius: 8px;\">\n                                ${escapeHtml(submission.feedback)}\n                            </div>\n                        ` : \'\'}\n                    `;\n\n                    modal.classList.add(\'active\');\n                })\n                .catch(error => {\n                    console.error(\'Error:\', error);\n                    alert(\'Failed to load feedback\');\n                });\n        }\n\n        function closeModal() {\n            document.getElementById(\'feedbackModal\').classList.remove(\'active\');\n        }\n\n        function escapeHtml(text) {\n            const div = document.createElement(\'div\');\n            div.textContent = text;\n            return div.innerHTML;\n        }\n\n        window.onclick = function(event) {\n            const modal = document.getElementById(\'feedbackModal\');\n            if (event.target === modal) {\n                closeModal();\n            }\n        }\n    </script>\n</body>\n</html>', 'passed', 10, 'Congratulations! Your solution meets the requirements. Good: Code has substantial implementation. Good: Code includes comments. Good: Code structure detected. ', 3, 3, '2025-10-11 16:03:00'),
(9, 2, 5, '<?php\nsession_start();\ninclude \'db_connect.php\';\n\n// Check if user is student\nif (!isset($_SESSION[\'user_id\']) || $_SESSION[\'role\'] !== \'student\') {\n    header(\"Location: login.php\");\n    exit();\n}\n\n$student_id = $_SESSION[\'user_id\'];\n$student_name = $_SESSION[\'full_name\'];\n\n// Get all submissions with feedback\n$submissions_query = \"\n    SELECT \n        es.*,\n        e.title as exercise_title,\n        e.points as max_points,\n        l.title as lesson_title,\n        l.category,\n        (SELECT COUNT(*) FROM instructor_feedback if2 WHERE if2.submission_id = es.id) as feedback_count,\n        (SELECT MAX(if3.created_at) FROM instructor_feedback if3 WHERE if3.submission_id = es.id) as last_feedback_date\n    FROM exercise_submissions es\n    JOIN exercises e ON e.id = es.exercise_id\n    JOIN lessons l ON l.id = e.lesson_id\n    WHERE es.student_id = ?\n    ORDER BY es.submitted_at DESC\n\";\n\n$stmt = $conn->prepare($submissions_query);\n$stmt->bind_param(\"i\", $student_id);\n$stmt->execute();\n$submissions = $stmt->get_result();\n\n// Count feedback\n$total_feedback_count = 0;\n$new_feedback_count = 0;\n$submissions_array = [];\n\nwhile ($row = $submissions->fetch_assoc()) {\n    $total_feedback_count += $row[\'feedback_count\'];\n    $submissions_array[] = $row;\n}\n?>\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>My Feedback - Code Lab @ HELP</title>\n    <style>\n        * {\n            margin: 0;\n            padding: 0;\n            box-sizing: border-box;\n        }\n\n        body {\n            font-family: \'Segoe UI\', sans-serif;\n            background-color: #2e3f54;\n            color: white;\n        }\n\n        .navbar {\n            background-color: #111;\n            padding: 1rem 2rem;\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n        }\n\n        .logo { color: white; font-weight: bold; font-size: 1.2rem; }\n        .nav-links { list-style: none; display: flex; gap: 1.5rem; }\n        .nav-links li a { color: white; text-decoration: none; }\n        .nav-icons { display: flex; align-items: center; gap: 1rem; }\n        \n        .logout-btn {\n            background-color: #2e3f54;\n            color: white;\n            border: none;\n            padding: 0.4rem 1rem;\n            border-radius: 5px;\n            cursor: pointer;\n        }\n\n        .container {\n            max-width: 1400px;\n            margin: 0 auto;\n            padding: 2rem;\n        }\n\n        .page-header {\n            margin-bottom: 2rem;\n        }\n\n        .page-header h1 {\n            font-size: 2rem;\n            margin-bottom: 0.5rem;\n        }\n\n        .stats-card {\n            background-color: #1a2332;\n            padding: 2rem;\n            border-radius: 12px;\n            text-align: center;\n            margin-bottom: 2rem;\n        }\n\n        .stat-value {\n            font-size: 3rem;\n            font-weight: bold;\n            color: #358efb;\n        }\n\n        .stat-label {\n            color: #aaa;\n            margin-top: 0.5rem;\n            font-size: 1.1rem;\n        }\n\n        .submissions-grid {\n            display: grid;\n            gap: 1.5rem;\n        }\n\n        .submission-card {\n            background-color: #1a2332;\n            padding: 1.5rem;\n            border-radius: 12px;\n            border-left: 4px solid #358efb;\n            transition: all 0.2s;\n        }\n\n        .submission-card:hover {\n            background-color: #1f2a3a;\n            transform: translateY(-2px);\n        }\n\n        .submission-card.has-feedback {\n            border-left-color: #4caf50;\n        }\n\n        .submission-header {\n            display: flex;\n            justify-content: space-between;\n            align-items: start;\n            margin-bottom: 1rem;\n        }\n\n        .submission-title {\n            font-size: 1.2rem;\n            font-weight: bold;\n            color: #358efb;\n        }\n\n        .feedback-badge {\n            background-color: #4caf50;\n            color: white;\n            padding: 0.4rem 0.8rem;\n            border-radius: 20px;\n            font-size: 0.9rem;\n            font-weight: bold;\n        }\n\n        .submission-meta {\n            display: flex;\n            gap: 2rem;\n            margin: 1rem 0;\n            color: #aaa;\n            font-size: 0.9rem;\n        }\n\n        .status-badge {\n            padding: 0.3rem 0.8rem;\n            border-radius: 20px;\n            font-size: 0.85rem;\n            font-weight: bold;\n        }\n\n        .status-passed { background-color: #4caf50; color: white; }\n        .status-failed { background-color: #f44336; color: white; }\n        .status-pending { background-color: #ff9800; color: white; }\n\n        .btn-view {\n            padding: 0.6rem 1.2rem;\n            background-color: #358efb;\n            color: white;\n            border: none;\n            border-radius: 8px;\n            cursor: pointer;\n            font-weight: bold;\n            margin-top: 1rem;\n        }\n\n        .btn-view:hover {\n            background-color: #2a72c9;\n        }\n\n        /* Modal */\n        .modal {\n            display: none;\n            position: fixed;\n            top: 0;\n            left: 0;\n            width: 100%;\n            height: 100%;\n            background-color: rgba(0,0,0,0.8);\n            z-index: 1000;\n            overflow-y: auto;\n        }\n\n        .modal.active {\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            padding: 2rem;\n        }\n\n        .modal-content {\n            background-color: #1a2332;\n            padding: 2rem;\n            border-radius: 12px;\n            max-width: 900px;\n            width: 100%;\n            max-height: 90vh;\n            overflow-y: auto;\n        }\n\n        .modal-header {\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            margin-bottom: 1.5rem;\n            padding-bottom: 1rem;\n            border-bottom: 2px solid #2e3f54;\n        }\n\n        .close-btn {\n            background: none;\n            border: none;\n            color: white;\n            font-size: 2rem;\n            cursor: pointer;\n        }\n\n        .section-title {\n            font-size: 1.3rem;\n            font-weight: bold;\n            margin: 1.5rem 0 1rem;\n            color: #358efb;\n        }\n\n        .code-viewer {\n            background-color: #1e1e1e;\n            padding: 1.5rem;\n            border-radius: 8px;\n            margin: 1rem 0;\n            overflow-x: auto;\n        }\n\n        .code-viewer pre {\n            color: #d4d4d4;\n            font-family: \'Courier New\', monospace;\n            font-size: 14px;\n            white-space: pre-wrap;\n        }\n\n        .feedback-item {\n            background-color: #2e3f54;\n            padding: 1.5rem;\n            border-radius: 8px;\n            margin-bottom: 1rem;\n            border-left: 4px solid #4caf50;\n        }\n\n        .feedback-header {\n            display: flex;\n            justify-content: space-between;\n            margin-bottom: 1rem;\n            color: #aaa;\n        }\n\n        .feedback-text {\n            color: white;\n            line-height: 1.6;\n            margin-bottom: 1rem;\n        }\n\n        .manual-grade {\n            background-color: #4caf50;\n            color: white;\n            padding: 0.5rem 1rem;\n            border-radius: 8px;\n            display: inline-block;\n        }\n\n        .empty-state {\n            background-color: #1a2332;\n            padding: 3rem;\n            border-radius: 12px;\n            text-align: center;\n            color: #888;\n        }\n\n        .empty-state h3 {\n            margin-bottom: 1rem;\n        }\n\n        .detail-row {\n            display: flex;\n            justify-content: space-between;\n            padding: 0.5rem 0;\n            border-bottom: 1px solid #2e3f54;\n        }\n\n        .detail-label {\n            color: #aaa;\n            font-weight: bold;\n        }\n    </style>\n</head>\n<body>\n    <nav class=\"navbar\">\n        <div class=\"logo\">Code Lab @ HELP</div>\n        <ul class=\"nav-links\">\n            <li><a href=\"studentDashboard.php\">Dashboard</a></li>\n            <li><a href=\"browser.php\">Browse</a></li>\n            <li><a href=\"exercises.php\">Exercises</a></li>\n            <li><a href=\"my_assignments.php\">My Assignments</a></li>\n            <li><a href=\"progress.php\">Progress</a></li>\n            <li><a href=\"my_feedback.php\">My Feedback</a></li>\n        </ul>\n        <div class=\"nav-icons\">\n            <span><?php echo htmlspecialchars($student_name); ?></span>\n            <button class=\"logout-btn\" onclick=\"confirmLogout()\">Log Out</button>\n        </div>\n    </nav>\n\n    <div class=\"container\">\n        <div class=\"page-header\">\n            <h1>My Instructor Feedback</h1>\n            <p style=\"color: #aaa;\">Review personalized feedback from your instructors</p>\n        </div>\n\n        <div class=\"stats-card\">\n            <div class=\"stat-value\"><?php echo $total_feedback_count; ?></div>\n            <div class=\"stat-label\">Total Feedback Received</div>\n        </div>\n\n        <div class=\"submissions-grid\">\n            <?php if (count($submissions_array) > 0): ?>\n                <?php foreach ($submissions_array as $submission): ?>\n                    <div class=\"submission-card <?php echo $submission[\'feedback_count\'] > 0 ? \'has-feedback\' : \'\'; ?>\">\n                        <div class=\"submission-header\">\n                            <div>\n                                <div class=\"submission-title\"><?php echo htmlspecialchars($submission[\'exercise_title\']); ?></div>\n                                <div style=\"color: #aaa; margin-top: 0.3rem;\">\n                                    <?php echo htmlspecialchars($submission[\'lesson_title\']); ?>\n                                </div>\n                            </div>\n                            <?php if ($submission[\'feedback_count\'] > 0): ?>\n                                <span class=\"feedback-badge\">\n                                    <?php echo $submission[\'feedback_count\']; ?> Feedback(s)\n                                </span>\n                            <?php endif; ?>\n                        </div>\n\n                        <div class=\"submission-meta\">\n                            <span>\n                                <span class=\"status-badge status-<?php echo $submission[\'status\']; ?>\">\n                                    <?php echo strtoupper($submission[\'status\']); ?>\n                                </span>\n                            </span>\n                            <span>Score: <strong><?php echo $submission[\'score\']; ?></strong> / <?php echo $submission[\'max_points\']; ?></span>\n                            <span>Submitted: <?php echo date(\'M j, Y g:i A\', strtotime($submission[\'submitted_at\'])); ?></span>\n                        </div>\n\n                        <?php if ($submission[\'feedback_count\'] > 0): ?>\n                            <div style=\"color: #4caf50; margin-top: 0.5rem;\">\n                                ‚úì Last feedback: <?php echo date(\'M j, g:i A\', strtotime($submission[\'last_feedback_date\'])); ?>\n                            </div>\n                        <?php endif; ?>\n\n                        <button class=\"btn-view\" onclick=\"viewFeedback(<?php echo $submission[\'id\']; ?>, <?php echo json_encode($submission); ?>)\">\n                            View Code & Feedback\n                        </button>\n                    </div>\n                <?php endforeach; ?>\n            <?php else: ?>\n                <div class=\"empty-state\">\n                    <h3>No submissions yet</h3>\n                    <p>Complete some exercises to receive instructor feedback!</p>\n                    <a href=\"exercises.php\" style=\"color: #358efb; text-decoration: none; font-weight: bold; margin-top: 1rem; display: inline-block;\">\n                        Go to Exercises ‚Üí\n                    </a>\n                </div>\n            <?php endif; ?>\n        </div>\n    </div>\n\n    <!-- Feedback Modal -->\n    <div class=\"modal\" id=\"feedbackModal\">\n        <div class=\"modal-content\">\n            <div class=\"modal-header\">\n                <h2>Submission & Feedback Details</h2>\n                <button class=\"close-btn\" onclick=\"closeModal()\">&times;</button>\n            </div>\n            <div id=\"modalBody\"></div>\n        </div>\n    </div>\n\n    <script>\n        function confirmLogout() {\n            if (confirm(\"Are you sure you want to log out?\")) {\n                window.location.href = \'logout.php\';\n            }\n        }\n\n        function viewFeedback(submissionId, submission) {\n            const modal = document.getElementById(\'feedbackModal\');\n            const modalBody = document.getElementById(\'modalBody\');\n\n            // Fetch feedback\n            fetch(`get_feedback.php?submission_id=${submissionId}`)\n                .then(response => response.json())\n                .then(data => {\n                    let feedbackHtml = \'\';\n                    \n                    if (data.success && data.feedback.length > 0) {\n                        feedbackHtml = \'<div class=\"section-title\">Instructor Feedback</div>\';\n                        data.feedback.forEach(fb => {\n                            const fbDate = new Date(fb.created_at).toLocaleString();\n                            feedbackHtml += `\n                                <div class=\"feedback-item\">\n                                    <div class=\"feedback-header\">\n                                        <span><strong>From: ${fb.instructor_name}</strong></span>\n                                        <span>${fbDate}</span>\n                                    </div>\n                                    <div class=\"feedback-text\">${escapeHtml(fb.feedback)}</div>\n                                    ${fb.grade !== null ? `\n                                        <div class=\"manual-grade\">\n                                            ‚≠ê Manual Grade: ${fb.grade} / ${submission.max_points}\n                                        </div>\n                                    ` : \'\'}\n                                </div>\n                            `;\n                        });\n                    } else {\n                        feedbackHtml = `\n                            <div style=\"text-align: center; padding: 2rem; color: #888;\">\n                                <h3>No instructor feedback yet</h3>\n                                <p>Your instructor hasn\'t provided feedback for this submission.</p>\n                            </div>\n                        `;\n                    }\n\n                    const statusClass = \'status-\' + submission.status;\n\n                    modalBody.innerHTML = `\n                        <div style=\"background-color: #2e3f54; padding: 1.5rem; border-radius: 8px; margin-bottom: 1.5rem;\">\n                            <div class=\"detail-row\">\n                                <span class=\"detail-label\">Exercise:</span>\n                                <span>${submission.exercise_title}</span>\n                            </div>\n                            <div class=\"detail-row\">\n                                <span class=\"detail-label\">Lesson:</span>\n                                <span>${submission.lesson_title}</span>\n                            </div>\n                            <div class=\"detail-row\">\n                                <span class=\"detail-label\">Status:</span>\n                                <span class=\"status-badge ${statusClass}\">${submission.status.toUpperCase()}</span>\n                            </div>\n                            <div class=\"detail-row\">\n                                <span class=\"detail-label\">Your Score:</span>\n                                <span><strong>${submission.score} / ${submission.max_points}</strong></span>\n                            </div>\n                            <div class=\"detail-row\">\n                                <span class=\"detail-label\">Submitted:</span>\n                                <span>${new Date(submission.submitted_at).toLocaleString()}</span>\n                            </div>\n                        </div>\n\n                        ${feedbackHtml}\n\n                        <div class=\"section-title\">Your Submitted Code</div>\n                        <div class=\"code-viewer\">\n                            <pre>${escapeHtml(submission.submitted_code)}</pre>\n                        </div>\n\n                        ${submission.feedback ? `\n                            <div class=\"section-title\">Auto-Generated Feedback</div>\n                            <div style=\"background-color: #2e3f54; padding: 1rem; border-radius: 8px;\">\n                                ${escapeHtml(submission.feedback)}\n                            </div>\n                        ` : \'\'}\n                    `;\n\n                    modal.classList.add(\'active\');\n                })\n                .catch(error => {\n                    console.error(\'Error:\', error);\n                    alert(\'Failed to load feedback\');\n                });\n        }\n\n        function closeModal() {\n            document.getElementById(\'feedbackModal\').classList.remove(\'active\');\n        }\n\n        function escapeHtml(text) {\n            const div = document.createElement(\'div\');\n            div.textContent = text;\n            return div.innerHTML;\n        }\n\n        window.onclick = function(event) {\n            const modal = document.getElementById(\'feedbackModal\');\n            if (event.target === modal) {\n                closeModal();\n            }\n        }\n    </script>\n</body>\n</html>', 'passed', 14, 'Congratulations! Your solution meets the requirements. Good: Code has substantial implementation. Good: Code includes comments. Good: Code structure detected. ', 3, 3, '2025-10-11 16:03:03');
INSERT INTO `exercise_submissions` (`id`, `exercise_id`, `student_id`, `submitted_code`, `status`, `score`, `feedback`, `passed_tests`, `total_tests`, `submitted_at`) VALUES
(10, 2, 5, '<?php\nsession_start();\ninclude \'db_connect.php\';\n\n// Check if user is student\nif (!isset($_SESSION[\'user_id\']) || $_SESSION[\'role\'] !== \'student\') {\n    header(\"Location: login.php\");\n    exit();\n}\n\n$student_id = $_SESSION[\'user_id\'];\n$student_name = $_SESSION[\'full_name\'];\n\n// Get all submissions with feedback\n$submissions_query = \"\n    SELECT \n        es.*,\n        e.title as exercise_title,\n        e.points as max_points,\n        l.title as lesson_title,\n        l.category,\n        (SELECT COUNT(*) FROM instructor_feedback if2 WHERE if2.submission_id = es.id) as feedback_count,\n        (SELECT MAX(if3.created_at) FROM instructor_feedback if3 WHERE if3.submission_id = es.id) as last_feedback_date\n    FROM exercise_submissions es\n    JOIN exercises e ON e.id = es.exercise_id\n    JOIN lessons l ON l.id = e.lesson_id\n    WHERE es.student_id = ?\n    ORDER BY es.submitted_at DESC\n\";\n\n$stmt = $conn->prepare($submissions_query);\n$stmt->bind_param(\"i\", $student_id);\n$stmt->execute();\n$submissions = $stmt->get_result();\n\n// Count feedback\n$total_feedback_count = 0;\n$new_feedback_count = 0;\n$submissions_array = [];\n\nwhile ($row = $submissions->fetch_assoc()) {\n    $total_feedback_count += $row[\'feedback_count\'];\n    $submissions_array[] = $row;\n}\n?>\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>My Feedback - Code Lab @ HELP</title>\n    <style>\n        * {\n            margin: 0;\n            padding: 0;\n            box-sizing: border-box;\n        }\n\n        body {\n            font-family: \'Segoe UI\', sans-serif;\n            background-color: #2e3f54;\n            color: white;\n        }\n\n        .navbar {\n            background-color: #111;\n            padding: 1rem 2rem;\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n        }\n\n        .logo { color: white; font-weight: bold; font-size: 1.2rem; }\n        .nav-links { list-style: none; display: flex; gap: 1.5rem; }\n        .nav-links li a { color: white; text-decoration: none; }\n        .nav-icons { display: flex; align-items: center; gap: 1rem; }\n        \n        .logout-btn {\n            background-color: #2e3f54;\n            color: white;\n            border: none;\n            padding: 0.4rem 1rem;\n            border-radius: 5px;\n            cursor: pointer;\n        }\n\n        .container {\n            max-width: 1400px;\n            margin: 0 auto;\n            padding: 2rem;\n        }\n\n        .page-header {\n            margin-bottom: 2rem;\n        }\n\n        .page-header h1 {\n            font-size: 2rem;\n            margin-bottom: 0.5rem;\n        }\n\n        .stats-card {\n            background-color: #1a2332;\n            padding: 2rem;\n            border-radius: 12px;\n            text-align: center;\n            margin-bottom: 2rem;\n        }\n\n        .stat-value {\n            font-size: 3rem;\n            font-weight: bold;\n            color: #358efb;\n        }\n\n        .stat-label {\n            color: #aaa;\n            margin-top: 0.5rem;\n            font-size: 1.1rem;\n        }\n\n        .submissions-grid {\n            display: grid;\n            gap: 1.5rem;\n        }\n\n        .submission-card {\n            background-color: #1a2332;\n            padding: 1.5rem;\n            border-radius: 12px;\n            border-left: 4px solid #358efb;\n            transition: all 0.2s;\n        }\n\n        .submission-card:hover {\n            background-color: #1f2a3a;\n            transform: translateY(-2px);\n        }\n\n        .submission-card.has-feedback {\n            border-left-color: #4caf50;\n        }\n\n        .submission-header {\n            display: flex;\n            justify-content: space-between;\n            align-items: start;\n            margin-bottom: 1rem;\n        }\n\n        .submission-title {\n            font-size: 1.2rem;\n            font-weight: bold;\n            color: #358efb;\n        }\n\n        .feedback-badge {\n            background-color: #4caf50;\n            color: white;\n            padding: 0.4rem 0.8rem;\n            border-radius: 20px;\n            font-size: 0.9rem;\n            font-weight: bold;\n        }\n\n        .submission-meta {\n            display: flex;\n            gap: 2rem;\n            margin: 1rem 0;\n            color: #aaa;\n            font-size: 0.9rem;\n        }\n\n        .status-badge {\n            padding: 0.3rem 0.8rem;\n            border-radius: 20px;\n            font-size: 0.85rem;\n            font-weight: bold;\n        }\n\n        .status-passed { background-color: #4caf50; color: white; }\n        .status-failed { background-color: #f44336; color: white; }\n        .status-pending { background-color: #ff9800; color: white; }\n\n        .btn-view {\n            padding: 0.6rem 1.2rem;\n            background-color: #358efb;\n            color: white;\n            border: none;\n            border-radius: 8px;\n            cursor: pointer;\n            font-weight: bold;\n            margin-top: 1rem;\n        }\n\n        .btn-view:hover {\n            background-color: #2a72c9;\n        }\n\n        /* Modal */\n        .modal {\n            display: none;\n            position: fixed;\n            top: 0;\n            left: 0;\n            width: 100%;\n            height: 100%;\n            background-color: rgba(0,0,0,0.8);\n            z-index: 1000;\n            overflow-y: auto;\n        }\n\n        .modal.active {\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            padding: 2rem;\n        }\n\n        .modal-content {\n            background-color: #1a2332;\n            padding: 2rem;\n            border-radius: 12px;\n            max-width: 900px;\n            width: 100%;\n            max-height: 90vh;\n            overflow-y: auto;\n        }\n\n        .modal-header {\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            margin-bottom: 1.5rem;\n            padding-bottom: 1rem;\n            border-bottom: 2px solid #2e3f54;\n        }\n\n        .close-btn {\n            background: none;\n            border: none;\n            color: white;\n            font-size: 2rem;\n            cursor: pointer;\n        }\n\n        .section-title {\n            font-size: 1.3rem;\n            font-weight: bold;\n            margin: 1.5rem 0 1rem;\n            color: #358efb;\n        }\n\n        .code-viewer {\n            background-color: #1e1e1e;\n            padding: 1.5rem;\n            border-radius: 8px;\n            margin: 1rem 0;\n            overflow-x: auto;\n        }\n\n        .code-viewer pre {\n            color: #d4d4d4;\n            font-family: \'Courier New\', monospace;\n            font-size: 14px;\n            white-space: pre-wrap;\n        }\n\n        .feedback-item {\n            background-color: #2e3f54;\n            padding: 1.5rem;\n            border-radius: 8px;\n            margin-bottom: 1rem;\n            border-left: 4px solid #4caf50;\n        }\n\n        .feedback-header {\n            display: flex;\n            justify-content: space-between;\n            margin-bottom: 1rem;\n            color: #aaa;\n        }\n\n        .feedback-text {\n            color: white;\n            line-height: 1.6;\n            margin-bottom: 1rem;\n        }\n\n        .manual-grade {\n            background-color: #4caf50;\n            color: white;\n            padding: 0.5rem 1rem;\n            border-radius: 8px;\n            display: inline-block;\n        }\n\n        .empty-state {\n            background-color: #1a2332;\n            padding: 3rem;\n            border-radius: 12px;\n            text-align: center;\n            color: #888;\n        }\n\n        .empty-state h3 {\n            margin-bottom: 1rem;\n        }\n\n        .detail-row {\n            display: flex;\n            justify-content: space-between;\n            padding: 0.5rem 0;\n            border-bottom: 1px solid #2e3f54;\n        }\n\n        .detail-label {\n            color: #aaa;\n            font-weight: bold;\n        }\n    </style>\n</head>\n<body>\n    <nav class=\"navbar\">\n        <div class=\"logo\">Code Lab @ HELP</div>\n        <ul class=\"nav-links\">\n            <li><a href=\"studentDashboard.php\">Dashboard</a></li>\n            <li><a href=\"browser.php\">Browse</a></li>\n            <li><a href=\"exercises.php\">Exercises</a></li>\n            <li><a href=\"my_assignments.php\">My Assignments</a></li>\n            <li><a href=\"progress.php\">Progress</a></li>\n            <li><a href=\"my_feedback.php\">My Feedback</a></li>\n        </ul>\n        <div class=\"nav-icons\">\n            <span><?php echo htmlspecialchars($student_name); ?></span>\n            <button class=\"logout-btn\" onclick=\"confirmLogout()\">Log Out</button>\n        </div>\n    </nav>\n\n    <div class=\"container\">\n        <div class=\"page-header\">\n            <h1>My Instructor Feedback</h1>\n            <p style=\"color: #aaa;\">Review personalized feedback from your instructors</p>\n        </div>\n\n        <div class=\"stats-card\">\n            <div class=\"stat-value\"><?php echo $total_feedback_count; ?></div>\n            <div class=\"stat-label\">Total Feedback Received</div>\n        </div>\n\n        <div class=\"submissions-grid\">\n            <?php if (count($submissions_array) > 0): ?>\n                <?php foreach ($submissions_array as $submission): ?>\n                    <div class=\"submission-card <?php echo $submission[\'feedback_count\'] > 0 ? \'has-feedback\' : \'\'; ?>\">\n                        <div class=\"submission-header\">\n                            <div>\n                                <div class=\"submission-title\"><?php echo htmlspecialchars($submission[\'exercise_title\']); ?></div>\n                                <div style=\"color: #aaa; margin-top: 0.3rem;\">\n                                    <?php echo htmlspecialchars($submission[\'lesson_title\']); ?>\n                                </div>\n                            </div>\n                            <?php if ($submission[\'feedback_count\'] > 0): ?>\n                                <span class=\"feedback-badge\">\n                                    <?php echo $submission[\'feedback_count\']; ?> Feedback(s)\n                                </span>\n                            <?php endif; ?>\n                        </div>\n\n                        <div class=\"submission-meta\">\n                            <span>\n                                <span class=\"status-badge status-<?php echo $submission[\'status\']; ?>\">\n                                    <?php echo strtoupper($submission[\'status\']); ?>\n                                </span>\n                            </span>\n                            <span>Score: <strong><?php echo $submission[\'score\']; ?></strong> / <?php echo $submission[\'max_points\']; ?></span>\n                            <span>Submitted: <?php echo date(\'M j, Y g:i A\', strtotime($submission[\'submitted_at\'])); ?></span>\n                        </div>\n\n                        <?php if ($submission[\'feedback_count\'] > 0): ?>\n                            <div style=\"color: #4caf50; margin-top: 0.5rem;\">\n                                ‚úì Last feedback: <?php echo date(\'M j, g:i A\', strtotime($submission[\'last_feedback_date\'])); ?>\n                            </div>\n                        <?php endif; ?>\n\n                        <button class=\"btn-view\" onclick=\"viewFeedback(<?php echo $submission[\'id\']; ?>, <?php echo json_encode($submission); ?>)\">\n                            View Code & Feedback\n                        </button>\n                    </div>\n                <?php endforeach; ?>\n            <?php else: ?>\n                <div class=\"empty-state\">\n                    <h3>No submissions yet</h3>\n                    <p>Complete some exercises to receive instructor feedback!</p>\n                    <a href=\"exercises.php\" style=\"color: #358efb; text-decoration: none; font-weight: bold; margin-top: 1rem; display: inline-block;\">\n                        Go to Exercises ‚Üí\n                    </a>\n                </div>\n            <?php endif; ?>\n        </div>\n    </div>\n\n    <!-- Feedback Modal -->\n    <div class=\"modal\" id=\"feedbackModal\">\n        <div class=\"modal-content\">\n            <div class=\"modal-header\">\n                <h2>Submission & Feedback Details</h2>\n                <button class=\"close-btn\" onclick=\"closeModal()\">&times;</button>\n            </div>\n            <div id=\"modalBody\"></div>\n        </div>\n    </div>\n\n    <script>\n        function confirmLogout() {\n            if (confirm(\"Are you sure you want to log out?\")) {\n                window.location.href = \'logout.php\';\n            }\n        }\n\n        function viewFeedback(submissionId, submission) {\n            const modal = document.getElementById(\'feedbackModal\');\n            const modalBody = document.getElementById(\'modalBody\');\n\n            // Fetch feedback\n            fetch(`get_feedback.php?submission_id=${submissionId}`)\n                .then(response => response.json())\n                .then(data => {\n                    let feedbackHtml = \'\';\n                    \n                    if (data.success && data.feedback.length > 0) {\n                        feedbackHtml = \'<div class=\"section-title\">Instructor Feedback</div>\';\n                        data.feedback.forEach(fb => {\n                            const fbDate = new Date(fb.created_at).toLocaleString();\n                            feedbackHtml += `\n                                <div class=\"feedback-item\">\n                                    <div class=\"feedback-header\">\n                                        <span><strong>From: ${fb.instructor_name}</strong></span>\n                                        <span>${fbDate}</span>\n                                    </div>\n                                    <div class=\"feedback-text\">${escapeHtml(fb.feedback)}</div>\n                                    ${fb.grade !== null ? `\n                                        <div class=\"manual-grade\">\n                                            ‚≠ê Manual Grade: ${fb.grade} / ${submission.max_points}\n                                        </div>\n                                    ` : \'\'}\n                                </div>\n                            `;\n                        });\n                    } else {\n                        feedbackHtml = `\n                            <div style=\"text-align: center; padding: 2rem; color: #888;\">\n                                <h3>No instructor feedback yet</h3>\n                                <p>Your instructor hasn\'t provided feedback for this submission.</p>\n                            </div>\n                        `;\n                    }\n\n                    const statusClass = \'status-\' + submission.status;\n\n                    modalBody.innerHTML = `\n                        <div style=\"background-color: #2e3f54; padding: 1.5rem; border-radius: 8px; margin-bottom: 1.5rem;\">\n                            <div class=\"detail-row\">\n                                <span class=\"detail-label\">Exercise:</span>\n                                <span>${submission.exercise_title}</span>\n                            </div>\n                            <div class=\"detail-row\">\n                                <span class=\"detail-label\">Lesson:</span>\n                                <span>${submission.lesson_title}</span>\n                            </div>\n                            <div class=\"detail-row\">\n                                <span class=\"detail-label\">Status:</span>\n                                <span class=\"status-badge ${statusClass}\">${submission.status.toUpperCase()}</span>\n                            </div>\n                            <div class=\"detail-row\">\n                                <span class=\"detail-label\">Your Score:</span>\n                                <span><strong>${submission.score} / ${submission.max_points}</strong></span>\n                            </div>\n                            <div class=\"detail-row\">\n                                <span class=\"detail-label\">Submitted:</span>\n                                <span>${new Date(submission.submitted_at).toLocaleString()}</span>\n                            </div>\n                        </div>\n\n                        ${feedbackHtml}\n\n                        <div class=\"section-title\">Your Submitted Code</div>\n                        <div class=\"code-viewer\">\n                            <pre>${escapeHtml(submission.submitted_code)}</pre>\n                        </div>\n\n                        ${submission.feedback ? `\n                            <div class=\"section-title\">Auto-Generated Feedback</div>\n                            <div style=\"background-color: #2e3f54; padding: 1rem; border-radius: 8px;\">\n                                ${escapeHtml(submission.feedback)}\n                            </div>\n                        ` : \'\'}\n                    `;\n\n                    modal.classList.add(\'active\');\n                })\n                .catch(error => {\n                    console.error(\'Error:\', error);\n                    alert(\'Failed to load feedback\');\n                });\n        }\n\n        function closeModal() {\n            document.getElementById(\'feedbackModal\').classList.remove(\'active\');\n        }\n\n        function escapeHtml(text) {\n            const div = document.createElement(\'div\');\n            div.textContent = text;\n            return div.innerHTML;\n        }\n\n        window.onclick = function(event) {\n            const modal = document.getElementById(\'feedbackModal\');\n            if (event.target === modal) {\n                closeModal();\n            }\n        }\n    </script>\n</body>\n</html>', 'passed', 14, 'Congratulations! Your solution meets the requirements. Good: Code has substantial implementation. Good: Code includes comments. Good: Code structure detected. ', 3, 3, '2025-10-11 16:03:13');
INSERT INTO `exercise_submissions` (`id`, `exercise_id`, `student_id`, `submitted_code`, `status`, `score`, `feedback`, `passed_tests`, `total_tests`, `submitted_at`) VALUES
(11, 2, 5, '<?php\nsession_start();\ninclude \'db_connect.php\';\n\n// Check if user is student\nif (!isset($_SESSION[\'user_id\']) || $_SESSION[\'role\'] !== \'student\') {\n    header(\"Location: login.php\");\n    exit();\n}\n\n$student_id = $_SESSION[\'user_id\'];\n$student_name = $_SESSION[\'full_name\'];\n\n// Get all submissions with feedback\n$submissions_query = \"\n    SELECT \n        es.*,\n        e.title as exercise_title,\n        e.points as max_points,\n        l.title as lesson_title,\n        l.category,\n        (SELECT COUNT(*) FROM instructor_feedback if2 WHERE if2.submission_id = es.id) as feedback_count,\n        (SELECT MAX(if3.created_at) FROM instructor_feedback if3 WHERE if3.submission_id = es.id) as last_feedback_date\n    FROM exercise_submissions es\n    JOIN exercises e ON e.id = es.exercise_id\n    JOIN lessons l ON l.id = e.lesson_id\n    WHERE es.student_id = ?\n    ORDER BY es.submitted_at DESC\n\";\n\n$stmt = $conn->prepare($submissions_query);\n$stmt->bind_param(\"i\", $student_id);\n$stmt->execute();\n$submissions = $stmt->get_result();\n\n// Count feedback\n$total_feedback_count = 0;\n$new_feedback_count = 0;\n$submissions_array = [];\n\nwhile ($row = $submissions->fetch_assoc()) {\n    $total_feedback_count += $row[\'feedback_count\'];\n    $submissions_array[] = $row;\n}\n?>\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>My Feedback - Code Lab @ HELP</title>\n    <style>\n        * {\n            margin: 0;\n            padding: 0;\n            box-sizing: border-box;\n        }\n\n        body {\n            font-family: \'Segoe UI\', sans-serif;\n            background-color: #2e3f54;\n            color: white;\n        }\n\n        .navbar {\n            background-color: #111;\n            padding: 1rem 2rem;\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n        }\n\n        .logo { color: white; font-weight: bold; font-size: 1.2rem; }\n        .nav-links { list-style: none; display: flex; gap: 1.5rem; }\n        .nav-links li a { color: white; text-decoration: none; }\n        .nav-icons { display: flex; align-items: center; gap: 1rem; }\n        \n        .logout-btn {\n            background-color: #2e3f54;\n            color: white;\n            border: none;\n            padding: 0.4rem 1rem;\n            border-radius: 5px;\n            cursor: pointer;\n        }\n\n        .container {\n            max-width: 1400px;\n            margin: 0 auto;\n            padding: 2rem;\n        }\n\n        .page-header {\n            margin-bottom: 2rem;\n        }\n\n        .page-header h1 {\n            font-size: 2rem;\n            margin-bottom: 0.5rem;\n        }\n\n        .stats-card {\n            background-color: #1a2332;\n            padding: 2rem;\n            border-radius: 12px;\n            text-align: center;\n            margin-bottom: 2rem;\n        }\n\n        .stat-value {\n            font-size: 3rem;\n            font-weight: bold;\n            color: #358efb;\n        }\n\n        .stat-label {\n            color: #aaa;\n            margin-top: 0.5rem;\n            font-size: 1.1rem;\n        }\n\n        .submissions-grid {\n            display: grid;\n            gap: 1.5rem;\n        }\n\n        .submission-card {\n            background-color: #1a2332;\n            padding: 1.5rem;\n            border-radius: 12px;\n            border-left: 4px solid #358efb;\n            transition: all 0.2s;\n        }\n\n        .submission-card:hover {\n            background-color: #1f2a3a;\n            transform: translateY(-2px);\n        }\n\n        .submission-card.has-feedback {\n            border-left-color: #4caf50;\n        }\n\n        .submission-header {\n            display: flex;\n            justify-content: space-between;\n            align-items: start;\n            margin-bottom: 1rem;\n        }\n\n        .submission-title {\n            font-size: 1.2rem;\n            font-weight: bold;\n            color: #358efb;\n        }\n\n        .feedback-badge {\n            background-color: #4caf50;\n            color: white;\n            padding: 0.4rem 0.8rem;\n            border-radius: 20px;\n            font-size: 0.9rem;\n            font-weight: bold;\n        }\n\n        .submission-meta {\n            display: flex;\n            gap: 2rem;\n            margin: 1rem 0;\n            color: #aaa;\n            font-size: 0.9rem;\n        }\n\n        .status-badge {\n            padding: 0.3rem 0.8rem;\n            border-radius: 20px;\n            font-size: 0.85rem;\n            font-weight: bold;\n        }\n\n        .status-passed { background-color: #4caf50; color: white; }\n        .status-failed { background-color: #f44336; color: white; }\n        .status-pending { background-color: #ff9800; color: white; }\n\n        .btn-view {\n            padding: 0.6rem 1.2rem;\n            background-color: #358efb;\n            color: white;\n            border: none;\n            border-radius: 8px;\n            cursor: pointer;\n            font-weight: bold;\n            margin-top: 1rem;\n        }\n\n        .btn-view:hover {\n            background-color: #2a72c9;\n        }\n\n        /* Modal */\n        .modal {\n            display: none;\n            position: fixed;\n            top: 0;\n            left: 0;\n            width: 100%;\n            height: 100%;\n            background-color: rgba(0,0,0,0.8);\n            z-index: 1000;\n            overflow-y: auto;\n        }\n\n        .modal.active {\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            padding: 2rem;\n        }\n\n        .modal-content {\n            background-color: #1a2332;\n            padding: 2rem;\n            border-radius: 12px;\n            max-width: 900px;\n            width: 100%;\n            max-height: 90vh;\n            overflow-y: auto;\n        }\n\n        .modal-header {\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            margin-bottom: 1.5rem;\n            padding-bottom: 1rem;\n            border-bottom: 2px solid #2e3f54;\n        }\n\n        .close-btn {\n            background: none;\n            border: none;\n            color: white;\n            font-size: 2rem;\n            cursor: pointer;\n        }\n\n        .section-title {\n            font-size: 1.3rem;\n            font-weight: bold;\n            margin: 1.5rem 0 1rem;\n            color: #358efb;\n        }\n\n        .code-viewer {\n            background-color: #1e1e1e;\n            padding: 1.5rem;\n            border-radius: 8px;\n            margin: 1rem 0;\n            overflow-x: auto;\n        }\n\n        .code-viewer pre {\n            color: #d4d4d4;\n            font-family: \'Courier New\', monospace;\n            font-size: 14px;\n            white-space: pre-wrap;\n        }\n\n        .feedback-item {\n            background-color: #2e3f54;\n            padding: 1.5rem;\n            border-radius: 8px;\n            margin-bottom: 1rem;\n            border-left: 4px solid #4caf50;\n        }\n\n        .feedback-header {\n            display: flex;\n            justify-content: space-between;\n            margin-bottom: 1rem;\n            color: #aaa;\n        }\n\n        .feedback-text {\n            color: white;\n            line-height: 1.6;\n            margin-bottom: 1rem;\n        }\n\n        .manual-grade {\n            background-color: #4caf50;\n            color: white;\n            padding: 0.5rem 1rem;\n            border-radius: 8px;\n            display: inline-block;\n        }\n\n        .empty-state {\n            background-color: #1a2332;\n            padding: 3rem;\n            border-radius: 12px;\n            text-align: center;\n            color: #888;\n        }\n\n        .empty-state h3 {\n            margin-bottom: 1rem;\n        }\n\n        .detail-row {\n            display: flex;\n            justify-content: space-between;\n            padding: 0.5rem 0;\n            border-bottom: 1px solid #2e3f54;\n        }\n\n        .detail-label {\n            color: #aaa;\n            font-weight: bold;\n        }\n    </style>\n</head>\n<body>\n    <nav class=\"navbar\">\n        <div class=\"logo\">Code Lab @ HELP</div>\n        <ul class=\"nav-links\">\n            <li><a href=\"studentDashboard.php\">Dashboard</a></li>\n            <li><a href=\"browser.php\">Browse</a></li>\n            <li><a href=\"exercises.php\">Exercises</a></li>\n            <li><a href=\"my_assignments.php\">My Assignments</a></li>\n            <li><a href=\"progress.php\">Progress</a></li>\n            <li><a href=\"my_feedback.php\">My Feedback</a></li>\n        </ul>\n        <div class=\"nav-icons\">\n            <span><?php echo htmlspecialchars($student_name); ?></span>\n            <button class=\"logout-btn\" onclick=\"confirmLogout()\">Log Out</button>\n        </div>\n    </nav>\n\n    <div class=\"container\">\n        <div class=\"page-header\">\n            <h1>My Instructor Feedback</h1>\n            <p style=\"color: #aaa;\">Review personalized feedback from your instructors</p>\n        </div>\n\n        <div class=\"stats-card\">\n            <div class=\"stat-value\"><?php echo $total_feedback_count; ?></div>\n            <div class=\"stat-label\">Total Feedback Received</div>\n        </div>\n\n        <div class=\"submissions-grid\">\n            <?php if (count($submissions_array) > 0): ?>\n                <?php foreach ($submissions_array as $submission): ?>\n                    <div class=\"submission-card <?php echo $submission[\'feedback_count\'] > 0 ? \'has-feedback\' : \'\'; ?>\">\n                        <div class=\"submission-header\">\n                            <div>\n                                <div class=\"submission-title\"><?php echo htmlspecialchars($submission[\'exercise_title\']); ?></div>\n                                <div style=\"color: #aaa; margin-top: 0.3rem;\">\n                                    <?php echo htmlspecialchars($submission[\'lesson_title\']); ?>\n                                </div>\n                            </div>\n                            <?php if ($submission[\'feedback_count\'] > 0): ?>\n                                <span class=\"feedback-badge\">\n                                    <?php echo $submission[\'feedback_count\']; ?> Feedback(s)\n                                </span>\n                            <?php endif; ?>\n                        </div>\n\n                        <div class=\"submission-meta\">\n                            <span>\n                                <span class=\"status-badge status-<?php echo $submission[\'status\']; ?>\">\n                                    <?php echo strtoupper($submission[\'status\']); ?>\n                                </span>\n                            </span>\n                            <span>Score: <strong><?php echo $submission[\'score\']; ?></strong> / <?php echo $submission[\'max_points\']; ?></span>\n                            <span>Submitted: <?php echo date(\'M j, Y g:i A\', strtotime($submission[\'submitted_at\'])); ?></span>\n                        </div>\n\n                        <?php if ($submission[\'feedback_count\'] > 0): ?>\n                            <div style=\"color: #4caf50; margin-top: 0.5rem;\">\n                                ‚úì Last feedback: <?php echo date(\'M j, g:i A\', strtotime($submission[\'last_feedback_date\'])); ?>\n                            </div>\n                        <?php endif; ?>\n\n                        <button class=\"btn-view\" onclick=\"viewFeedback(<?php echo $submission[\'id\']; ?>, <?php echo json_encode($submission); ?>)\">\n                            View Code & Feedback\n                        </button>\n                    </div>\n                <?php endforeach; ?>\n            <?php else: ?>\n                <div class=\"empty-state\">\n                    <h3>No submissions yet</h3>\n                    <p>Complete some exercises to receive instructor feedback!</p>\n                    <a href=\"exercises.php\" style=\"color: #358efb; text-decoration: none; font-weight: bold; margin-top: 1rem; display: inline-block;\">\n                        Go to Exercises ‚Üí\n                    </a>\n                </div>\n            <?php endif; ?>\n        </div>\n    </div>\n\n    <!-- Feedback Modal -->\n    <div class=\"modal\" id=\"feedbackModal\">\n        <div class=\"modal-content\">\n            <div class=\"modal-header\">\n                <h2>Submission & Feedback Details</h2>\n                <button class=\"close-btn\" onclick=\"closeModal()\">&times;</button>\n            </div>\n            <div id=\"modalBody\"></div>\n        </div>\n    </div>\n\n    <script>\n        function confirmLogout() {\n            if (confirm(\"Are you sure you want to log out?\")) {\n                window.location.href = \'logout.php\';\n            }\n        }\n\n        function viewFeedback(submissionId, submission) {\n            const modal = document.getElementById(\'feedbackModal\');\n            const modalBody = document.getElementById(\'modalBody\');\n\n            // Fetch feedback\n            fetch(`get_feedback.php?submission_id=${submissionId}`)\n                .then(response => response.json())\n                .then(data => {\n                    let feedbackHtml = \'\';\n                    \n                    if (data.success && data.feedback.length > 0) {\n                        feedbackHtml = \'<div class=\"section-title\">Instructor Feedback</div>\';\n                        data.feedback.forEach(fb => {\n                            const fbDate = new Date(fb.created_at).toLocaleString();\n                            feedbackHtml += `\n                                <div class=\"feedback-item\">\n                                    <div class=\"feedback-header\">\n                                        <span><strong>From: ${fb.instructor_name}</strong></span>\n                                        <span>${fbDate}</span>\n                                    </div>\n                                    <div class=\"feedback-text\">${escapeHtml(fb.feedback)}</div>\n                                    ${fb.grade !== null ? `\n                                        <div class=\"manual-grade\">\n                                            ‚≠ê Manual Grade: ${fb.grade} / ${submission.max_points}\n                                        </div>\n                                    ` : \'\'}\n                                </div>\n                            `;\n                        });\n                    } else {\n                        feedbackHtml = `\n                            <div style=\"text-align: center; padding: 2rem; color: #888;\">\n                                <h3>No instructor feedback yet</h3>\n                                <p>Your instructor hasn\'t provided feedback for this submission.</p>\n                            </div>\n                        `;\n                    }\n\n                    const statusClass = \'status-\' + submission.status;\n\n                    modalBody.innerHTML = `\n                        <div style=\"background-color: #2e3f54; padding: 1.5rem; border-radius: 8px; margin-bottom: 1.5rem;\">\n                            <div class=\"detail-row\">\n                                <span class=\"detail-label\">Exercise:</span>\n                                <span>${submission.exercise_title}</span>\n                            </div>\n                            <div class=\"detail-row\">\n                                <span class=\"detail-label\">Lesson:</span>\n                                <span>${submission.lesson_title}</span>\n                            </div>\n                            <div class=\"detail-row\">\n                                <span class=\"detail-label\">Status:</span>\n                                <span class=\"status-badge ${statusClass}\">${submission.status.toUpperCase()}</span>\n                            </div>\n                            <div class=\"detail-row\">\n                                <span class=\"detail-label\">Your Score:</span>\n                                <span><strong>${submission.score} / ${submission.max_points}</strong></span>\n                            </div>\n                            <div class=\"detail-row\">\n                                <span class=\"detail-label\">Submitted:</span>\n                                <span>${new Date(submission.submitted_at).toLocaleString()}</span>\n                            </div>\n                        </div>\n\n                        ${feedbackHtml}\n\n                        <div class=\"section-title\">Your Submitted Code</div>\n                        <div class=\"code-viewer\">\n                            <pre>${escapeHtml(submission.submitted_code)}</pre>\n                        </div>\n\n                        ${submission.feedback ? `\n                            <div class=\"section-title\">Auto-Generated Feedback</div>\n                            <div style=\"background-color: #2e3f54; padding: 1rem; border-radius: 8px;\">\n                                ${escapeHtml(submission.feedback)}\n                            </div>\n                        ` : \'\'}\n                    `;\n\n                    modal.classList.add(\'active\');\n                })\n                .catch(error => {\n                    console.error(\'Error:\', error);\n                    alert(\'Failed to load feedback\');\n                });\n        }\n\n        function closeModal() {\n            document.getElementById(\'feedbackModal\').classList.remove(\'active\');\n        }\n\n        function escapeHtml(text) {\n            const div = document.createElement(\'div\');\n            div.textContent = text;\n            return div.innerHTML;\n        }\n\n        window.onclick = function(event) {\n            const modal = document.getElementById(\'feedbackModal\');\n            if (event.target === modal) {\n                closeModal();\n            }\n        }\n    </script>\n</body>\n</html><?php\nsession_start();\ninclude \'db_connect.php\';\n\n// Check if user is student\nif (!isset($_SESSION[\'user_id\']) || $_SESSION[\'role\'] !== \'student\') {\n    header(\"Location: login.php\");\n    exit();\n}\n\n$student_id = $_SESSION[\'user_id\'];\n$student_name = $_SESSION[\'full_name\'];\n\n// Get all submissions with feedback\n$submissions_query = \"\n    SELECT \n        es.*,\n        e.title as exercise_title,\n        e.points as max_points,\n        l.title as lesson_title,\n        l.category,\n        (SELECT COUNT(*) FROM instructor_feedback if2 WHERE if2.submission_id = es.id) as feedback_count,\n        (SELECT MAX(if3.created_at) FROM instructor_feedback if3 WHERE if3.submission_id = es.id) as last_feedback_date\n    FROM exercise_submissions es\n    JOIN exercises e ON e.id = es.exercise_id\n    JOIN lessons l ON l.id = e.lesson_id\n    WHERE es.student_id = ?\n    ORDER BY es.submitted_at DESC\n\";\n\n$stmt = $conn->prepare($submissions_query);\n$stmt->bind_param(\"i\", $student_id);\n$stmt->execute();\n$submissions = $stmt->get_result();\n\n// Count feedback\n$total_feedback_count = 0;\n$new_feedback_count = 0;\n$submissions_array = [];\n\nwhile ($row = $submissions->fetch_assoc()) {\n    $total_feedback_count += $row[\'feedback_count\'];\n    $submissions_array[] = $row;\n}\n?>\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>My Feedback - Code Lab @ HELP</title>\n    <style>\n        * {\n            margin: 0;\n            padding: 0;\n            box-sizing: border-box;\n        }\n\n        body {\n            font-family: \'Segoe UI\', sans-serif;\n            background-color: #2e3f54;\n            color: white;\n        }\n\n        .navbar {\n            background-color: #111;\n            padding: 1rem 2rem;\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n        }\n\n        .logo { color: white; font-weight: bold; font-size: 1.2rem; }\n        .nav-links { list-style: none; display: flex; gap: 1.5rem; }\n        .nav-links li a { color: white; text-decoration: none; }\n        .nav-icons { display: flex; align-items: center; gap: 1rem; }\n        \n        .logout-btn {\n            background-color: #2e3f54;\n            color: white;\n            border: none;\n            padding: 0.4rem 1rem;\n            border-radius: 5px;\n            cursor: pointer;\n        }\n\n        .container {\n            max-width: 1400px;\n            margin: 0 auto;\n            padding: 2rem;\n        }\n\n        .page-header {\n            margin-bottom: 2rem;\n        }\n\n        .page-header h1 {\n            font-size: 2rem;\n            margin-bottom: 0.5rem;\n        }\n\n        .stats-card {\n            background-color: #1a2332;\n            padding: 2rem;\n            border-radius: 12px;\n            text-align: center;\n            margin-bottom: 2rem;\n        }\n\n        .stat-value {\n            font-size: 3rem;\n            font-weight: bold;\n            color: #358efb;\n        }\n\n        .stat-label {\n            color: #aaa;\n            margin-top: 0.5rem;\n            font-size: 1.1rem;\n        }\n\n        .submissions-grid {\n            display: grid;\n            gap: 1.5rem;\n        }\n\n        .submission-card {\n            background-color: #1a2332;\n            padding: 1.5rem;\n            border-radius: 12px;\n            border-left: 4px solid #358efb;\n            transition: all 0.2s;\n        }\n\n        .submission-card:hover {\n            background-color: #1f2a3a;\n            transform: translateY(-2px);\n        }\n\n        .submission-card.has-feedback {\n            border-left-color: #4caf50;\n        }\n\n        .submission-header {\n            display: flex;\n            justify-content: space-between;\n            align-items: start;\n            margin-bottom: 1rem;\n        }\n\n        .submission-title {\n            font-size: 1.2rem;\n            font-weight: bold;\n            color: #358efb;\n        }\n\n        .feedback-badge {\n            background-color: #4caf50;\n            color: white;\n            padding: 0.4rem 0.8rem;\n            border-radius: 20px;\n            font-size: 0.9rem;\n            font-weight: bold;\n        }\n\n        .submission-meta {\n            display: flex;\n            gap: 2rem;\n            margin: 1rem 0;\n            color: #aaa;\n            font-size: 0.9rem;\n        }\n\n        .status-badge {\n            padding: 0.3rem 0.8rem;\n            border-radius: 20px;\n            font-size: 0.85rem;\n            font-weight: bold;\n        }\n\n        .status-passed { background-color: #4caf50; color: white; }\n        .status-failed { background-color: #f44336; color: white; }\n        .status-pending { background-color: #ff9800; color: white; }\n\n        .btn-view {\n            padding: 0.6rem 1.2rem;\n            background-color: #358efb;\n            color: white;\n            border: none;\n            border-radius: 8px;\n            cursor: pointer;\n            font-weight: bold;\n            margin-top: 1rem;\n        }\n\n        .btn-view:hover {\n            background-color: #2a72c9;\n        }\n\n        /* Modal */\n        .modal {\n            display: none;\n            position: fixed;\n            top: 0;\n            left: 0;\n            width: 100%;\n            height: 100%;\n            background-color: rgba(0,0,0,0.8);\n            z-index: 1000;\n            overflow-y: auto;\n        }\n\n        .modal.active {\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            padding: 2rem;\n        }\n\n        .modal-content {\n            background-color: #1a2332;\n            padding: 2rem;\n            border-radius: 12px;\n            max-width: 900px;\n            width: 100%;\n            max-height: 90vh;\n            overflow-y: auto;\n        }\n\n        .modal-header {\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            margin-bottom: 1.5rem;\n            padding-bottom: 1rem;\n            border-bottom: 2px solid #2e3f54;\n        }\n\n        .close-btn {\n            background: none;\n            border: none;\n            color: white;\n            font-size: 2rem;\n            cursor: pointer;\n        }\n\n        .section-title {\n            font-size: 1.3rem;\n            font-weight: bold;\n            margin: 1.5rem 0 1rem;\n            color: #358efb;\n        }\n\n        .code-viewer {\n            background-color: #1e1e1e;\n            padding: 1.5rem;\n            border-radius: 8px;\n            margin: 1rem 0;\n            overflow-x: auto;\n        }\n\n        .code-viewer pre {\n            color: #d4d4d4;\n            font-family: \'Courier New\', monospace;\n            font-size: 14px;\n            white-space: pre-wrap;\n        }\n\n        .feedback-item {\n            background-color: #2e3f54;\n            padding: 1.5rem;\n            border-radius: 8px;\n            margin-bottom: 1rem;\n            border-left: 4px solid #4caf50;\n        }\n\n        .feedback-header {\n            display: flex;\n            justify-content: space-between;\n            margin-bottom: 1rem;\n            color: #aaa;\n        }\n\n        .feedback-text {\n            color: white;\n            line-height: 1.6;\n            margin-bottom: 1rem;\n        }\n\n        .manual-grade {\n            background-color: #4caf50;\n            color: white;\n            padding: 0.5rem 1rem;\n            border-radius: 8px;\n            display: inline-block;\n        }\n\n        .empty-state {\n            background-color: #1a2332;\n            padding: 3rem;\n            border-radius: 12px;\n            text-align: center;\n            color: #888;\n        }\n\n        .empty-state h3 {\n            margin-bottom: 1rem;\n        }\n\n        .detail-row {\n            display: flex;\n            justify-content: space-between;\n            padding: 0.5rem 0;\n            border-bottom: 1px solid #2e3f54;\n        }\n\n        .detail-label {\n            color: #aaa;\n            font-weight: bold;\n        }\n    </style>\n</head>\n<body>\n    <nav class=\"navbar\">\n        <div class=\"logo\">Code Lab @ HELP</div>\n        <ul class=\"nav-links\">\n            <li><a href=\"studentDashboard.php\">Dashboard</a></li>\n            <li><a href=\"browser.php\">Browse</a></li>\n            <li><a href=\"exercises.php\">Exercises</a></li>\n            <li><a href=\"my_assignments.php\">My Assignments</a></li>\n            <li><a href=\"progress.php\">Progress</a></li>\n            <li><a href=\"my_feedback.php\">My Feedback</a></li>\n        </ul>\n        <div class=\"nav-icons\">\n            <span><?php echo htmlspecialchars($student_name); ?></span>\n            <button class=\"logout-btn\" onclick=\"confirmLogout()\">Log Out</button>\n        </div>\n    </nav>\n\n    <div class=\"container\">\n        <div class=\"page-header\">\n            <h1>My Instructor Feedback</h1>\n            <p style=\"color: #aaa;\">Review personalized feedback from your instructors</p>\n        </div>\n\n        <div class=\"stats-card\">\n            <div class=\"stat-value\"><?php echo $total_feedback_count; ?></div>\n            <div class=\"stat-label\">Total Feedback Received</div>\n        </div>\n\n        <div class=\"submissions-grid\">\n            <?php if (count($submissions_array) > 0): ?>\n                <?php foreach ($submissions_array as $submission): ?>\n                    <div class=\"submission-card <?php echo $submission[\'feedback_count\'] > 0 ? \'has-feedback\' : \'\'; ?>\">\n                        <div class=\"submission-header\">\n                            <div>\n                                <div class=\"submission-title\"><?php echo htmlspecialchars($submission[\'exercise_title\']); ?></div>\n                                <div style=\"color: #aaa; margin-top: 0.3rem;\">\n                                    <?php echo htmlspecialchars($submission[\'lesson_title\']); ?>\n                                </div>\n                            </div>\n                            <?php if ($submission[\'feedback_count\'] > 0): ?>\n                                <span class=\"feedback-badge\">\n                                    <?php echo $submission[\'feedback_count\']; ?> Feedback(s)\n                                </span>\n                            <?php endif; ?>\n                        </div>\n\n                        <div class=\"submission-meta\">\n                            <span>\n                                <span class=\"status-badge status-<?php echo $submission[\'status\']; ?>\">\n                                    <?php echo strtoupper($submission[\'status\']); ?>\n                                </span>\n                            </span>\n                            <span>Score: <strong><?php echo $submission[\'score\']; ?></strong> / <?php echo $submission[\'max_points\']; ?></span>\n                            <span>Submitted: <?php echo date(\'M j, Y g:i A\', strtotime($submission[\'submitted_at\'])); ?></span>\n                        </div>\n\n                        <?php if ($submission[\'feedback_count\'] > 0): ?>\n                            <div style=\"color: #4caf50; margin-top: 0.5rem;\">\n                                ‚úì Last feedback: <?php echo date(\'M j, g:i A\', strtotime($submission[\'last_feedback_date\'])); ?>\n                            </div>\n                        <?php endif; ?>\n\n                        <button class=\"btn-view\" onclick=\"viewFeedback(<?php echo $submission[\'id\']; ?>, <?php echo json_encode($submission); ?>)\">\n                            View Code & Feedback\n                        </button>\n                    </div>\n                <?php endforeach; ?>\n            <?php else: ?>\n                <div class=\"empty-state\">\n                    <h3>No submissions yet</h3>\n                    <p>Complete some exercises to receive instructor feedback!</p>\n                    <a href=\"exercises.php\" style=\"color: #358efb; text-decoration: none; font-weight: bold; margin-top: 1rem; display: inline-block;\">\n                        Go to Exercises ‚Üí\n                    </a>\n                </div>\n            <?php endif; ?>\n        </div>\n    </div>\n\n    <!-- Feedback Modal -->\n    <div class=\"modal\" id=\"feedbackModal\">\n        <div class=\"modal-content\">\n            <div class=\"modal-header\">\n                <h2>Submission & Feedback Details</h2>\n                <button class=\"close-btn\" onclick=\"closeModal()\">&times;</button>\n            </div>\n            <div id=\"modalBody\"></div>\n        </div>\n    </div>\n\n    <script>\n        function confirmLogout() {\n            if (confirm(\"Are you sure you want to log out?\")) {\n                window.location.href = \'logout.php\';\n            }\n        }\n\n        function viewFeedback(submissionId, submission) {\n            const modal = document.getElementById(\'feedbackModal\');\n            const modalBody = document.getElementById(\'modalBody\');\n\n            // Fetch feedback\n            fetch(`get_feedback.php?submission_id=${submissionId}`)\n                .then(response => response.json())\n                .then(data => {\n                    let feedbackHtml = \'\';\n                    \n                    if (data.success && data.feedback.length > 0) {\n                        feedbackHtml = \'<div class=\"section-title\">Instructor Feedback</div>\';\n                        data.feedback.forEach(fb => {\n                            const fbDate = new Date(fb.created_at).toLocaleString();\n                            feedbackHtml += `\n                                <div class=\"feedback-item\">\n                                    <div class=\"feedback-header\">\n                                        <span><strong>From: ${fb.instructor_name}</strong></span>\n                                        <span>${fbDate}</span>\n                                    </div>\n                                    <div class=\"feedback-text\">${escapeHtml(fb.feedback)}</div>\n                                    ${fb.grade !== null ? `\n                                        <div class=\"manual-grade\">\n                                            ‚≠ê Manual Grade: ${fb.grade} / ${submission.max_points}\n                                        </div>\n                                    ` : \'\'}\n                                </div>\n                            `;\n                        });\n                    } else {\n                        feedbackHtml = `\n                            <div style=\"text-align: center; padding: 2rem; color: #888;\">\n                                <h3>No instructor feedback yet</h3>\n                                <p>Your instructor hasn\'t provided feedback for this submission.</p>\n                            </div>\n                        `;\n                    }\n\n                    const statusClass = \'status-\' + submission.status;\n\n                    modalBody.innerHTML = `\n                        <div style=\"background-color: #2e3f54; padding: 1.5rem; border-radius: 8px; margin-bottom: 1.5rem;\">\n                            <div class=\"detail-row\">\n                                <span class=\"detail-label\">Exercise:</span>\n                                <span>${submission.exercise_title}</span>\n                            </div>\n                            <div class=\"detail-row\">\n                                <span class=\"detail-label\">Lesson:</span>\n                                <span>${submission.lesson_title}</span>\n                            </div>\n                            <div class=\"detail-row\">\n                                <span class=\"detail-label\">Status:</span>\n                                <span class=\"status-badge ${statusClass}\">${submission.status.toUpperCase()}</span>\n                            </div>\n                            <div class=\"detail-row\">\n                                <span class=\"detail-label\">Your Score:</span>\n                                <span><strong>${submission.score} / ${submission.max_points}</strong></span>\n                            </div>\n                            <div class=\"detail-row\">\n                                <span class=\"detail-label\">Submitted:</span>\n                                <span>${new Date(submission.submitted_at).toLocaleString()}</span>\n                            </div>\n                        </div>\n\n                        ${feedbackHtml}\n\n                        <div class=\"section-title\">Your Submitted Code</div>\n                        <div class=\"code-viewer\">\n                            <pre>${escapeHtml(submission.submitted_code)}</pre>\n                        </div>\n\n                        ${submission.feedback ? `\n                            <div class=\"section-title\">Auto-Generated Feedback</div>\n                            <div style=\"background-color: #2e3f54; padding: 1rem; border-radius: 8px;\">\n                                ${escapeHtml(submission.feedback)}\n                            </div>\n                        ` : \'\'}\n                    `;\n\n                    modal.classList.add(\'active\');\n                })\n                .catch(error => {\n                    console.error(\'Error:\', error);\n                    alert(\'Failed to load feedback\');\n                });\n        }\n\n        function closeModal() {\n            document.getElementById(\'feedbackModal\').classList.remove(\'active\');\n        }\n\n        function escapeHtml(text) {\n            const div = document.createElement(\'div\');\n            div.textContent = text;\n            return div.innerHTML;\n        }\n\n        window.onclick = function(event) {\n            const modal = document.getElementById(\'feedbackModal\');\n            if (event.target === modal) {\n                closeModal();\n            }\n        }\n    </script>\n</body>\n</html>', 'passed', 15, 'Congratulations! Your solution meets the requirements. Good: Code has substantial implementation. Good: Code includes comments. Good: Code structure detected. ', 3, 3, '2025-10-11 16:03:20');

-- --------------------------------------------------------

--
-- Table structure for table `instructor_feedback`
--

CREATE TABLE `instructor_feedback` (
  `id` int(10) UNSIGNED NOT NULL,
  `submission_id` int(10) UNSIGNED NOT NULL,
  `instructor_id` int(10) UNSIGNED NOT NULL,
  `feedback` text NOT NULL,
  `grade` int(11) DEFAULT NULL,
  `created_at` timestamp NOT NULL DEFAULT current_timestamp()
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

--
-- Dumping data for table `instructor_feedback`
--

INSERT INTO `instructor_feedback` (`id`, `submission_id`, `instructor_id`, `feedback`, `grade`, `created_at`) VALUES
(1, 11, 4, 'GOOD JOB!!!', 15, '2025-10-11 16:06:43');

-- --------------------------------------------------------

--
-- Table structure for table `lessons`
--

CREATE TABLE `lessons` (
  `id` int(10) UNSIGNED NOT NULL,
  `title` varchar(200) NOT NULL,
  `description` text DEFAULT NULL,
  `category` enum('frontend','backend','fullstack') NOT NULL,
  `difficulty` enum('beginner','intermediate','advanced') DEFAULT 'beginner',
  `content_type` enum('video','text','interactive') DEFAULT 'text',
  `duration_minutes` int(11) DEFAULT 0,
  `order_index` int(11) DEFAULT 0,
  `is_published` tinyint(1) DEFAULT 1,
  `created_by` int(10) UNSIGNED DEFAULT NULL,
  `created_at` timestamp NOT NULL DEFAULT current_timestamp(),
  `updated_at` timestamp NOT NULL DEFAULT current_timestamp() ON UPDATE current_timestamp()
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

--
-- Dumping data for table `lessons`
--

INSERT INTO `lessons` (`id`, `title`, `description`, `category`, `difficulty`, `content_type`, `duration_minutes`, `order_index`, `is_published`, `created_by`, `created_at`, `updated_at`) VALUES
(1, 'HTML Basics', 'Learn the fundamentals of HTML structure and elements', 'frontend', 'beginner', 'text', 30, 1, 1, 1, '2025-10-02 03:09:33', '2025-10-02 03:09:33'),
(2, 'CSS Styling', 'Master CSS properties, selectors, and layout techniques', 'frontend', 'beginner', 'text', 45, 2, 1, 1, '2025-10-02 03:09:33', '2025-10-02 03:09:33'),
(3, 'JavaScript Fundamentals', 'Understanding variables, functions, and control flow', 'backend', 'intermediate', 'text', 60, 3, 1, 1, '2025-10-02 03:09:33', '2025-10-02 14:20:03'),
(6, 'a', 'a', 'fullstack', 'beginner', 'text', 30, 1, 1, 1, '2025-11-19 14:08:33', '2025-11-19 14:21:45');

-- --------------------------------------------------------

--
-- Table structure for table `lesson_progress`
--

CREATE TABLE `lesson_progress` (
  `id` int(11) NOT NULL,
  `student_id` int(11) NOT NULL,
  `lesson_id` int(11) NOT NULL,
  `topic` varchar(50) NOT NULL,
  `level` int(11) NOT NULL,
  `step` int(11) NOT NULL,
  `completed` tinyint(1) DEFAULT 0,
  `created_at` timestamp NOT NULL DEFAULT current_timestamp()
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `lesson_quiz_progress`
--

CREATE TABLE `lesson_quiz_progress` (
  `id` int(10) UNSIGNED NOT NULL,
  `student_id` int(10) UNSIGNED NOT NULL,
  `lesson_id` int(10) UNSIGNED NOT NULL,
  `quiz_score` int(11) DEFAULT 0,
  `quiz_total` int(11) DEFAULT 0,
  `quiz_passed` tinyint(1) DEFAULT 0,
  `attempts` int(11) DEFAULT 0,
  `completed_at` timestamp NULL DEFAULT NULL,
  `created_at` timestamp NOT NULL DEFAULT current_timestamp(),
  `updated_at` timestamp NOT NULL DEFAULT current_timestamp() ON UPDATE current_timestamp()
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

--
-- Dumping data for table `lesson_quiz_progress`
--

INSERT INTO `lesson_quiz_progress` (`id`, `student_id`, `lesson_id`, `quiz_score`, `quiz_total`, `quiz_passed`, `attempts`, `completed_at`, `created_at`, `updated_at`) VALUES
(1, 5, 1, 0, 10, 0, 2, '2025-11-18 10:06:47', '2025-11-18 06:47:15', '2025-11-18 10:06:47');

-- --------------------------------------------------------

--
-- Table structure for table `quiz_answers`
--

CREATE TABLE `quiz_answers` (
  `id` int(10) UNSIGNED NOT NULL,
  `student_id` int(10) UNSIGNED NOT NULL,
  `lesson_id` int(10) UNSIGNED NOT NULL,
  `question_number` int(11) NOT NULL,
  `student_answer` text NOT NULL,
  `is_correct` tinyint(1) DEFAULT 0,
  `answered_at` timestamp NOT NULL DEFAULT current_timestamp()
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `student_progress`
--

CREATE TABLE `student_progress` (
  `id` int(10) UNSIGNED NOT NULL,
  `student_id` int(10) UNSIGNED NOT NULL,
  `lesson_id` int(10) UNSIGNED NOT NULL,
  `status` enum('not_started','in_progress','completed') DEFAULT 'not_started',
  `completion_percentage` int(11) DEFAULT 0,
  `time_spent_minutes` int(11) DEFAULT 0,
  `started_at` timestamp NULL DEFAULT NULL,
  `completed_at` timestamp NULL DEFAULT NULL,
  `last_accessed` timestamp NOT NULL DEFAULT current_timestamp() ON UPDATE current_timestamp()
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

--
-- Dumping data for table `student_progress`
--

INSERT INTO `student_progress` (`id`, `student_id`, `lesson_id`, `status`, `completion_percentage`, `time_spent_minutes`, `started_at`, `completed_at`, `last_accessed`) VALUES
(1, 3, 1, 'in_progress', 40, 20, '2025-10-02 13:01:01', NULL, '2025-10-02 13:01:39'),
(2, 3, 2, 'in_progress', 10, 5, '2025-10-02 13:01:29', NULL, '2025-10-02 13:01:29'),
(4, 5, 1, 'in_progress', 20, 10, '2025-10-11 16:02:56', NULL, '2025-10-11 16:03:00'),
(5, 5, 2, 'in_progress', 30, 15, '2025-10-11 16:03:03', NULL, '2025-10-11 16:03:20');

-- --------------------------------------------------------

--
-- Table structure for table `system_settings`
--

CREATE TABLE `system_settings` (
  `id` int(11) UNSIGNED NOT NULL,
  `setting_key` varchar(100) NOT NULL,
  `setting_value` text DEFAULT NULL,
  `setting_category` varchar(50) DEFAULT 'general',
  `updated_at` timestamp NOT NULL DEFAULT current_timestamp() ON UPDATE current_timestamp(),
  `updated_by` int(11) UNSIGNED DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

--
-- Dumping data for table `system_settings`
--

INSERT INTO `system_settings` (`id`, `setting_key`, `setting_value`, `setting_category`, `updated_at`, `updated_by`) VALUES
(1, 'site_name', 'Code Lab @ HELP', 'platform', '2025-10-11 16:24:57', 1),
(2, 'site_description', 'Interactive Coding Learning Platform', 'platform', '2025-10-11 16:24:57', 1),
(3, 'registration_enabled', '1', 'features', '2025-10-11 16:24:57', 1),
(4, 'maintenance_mode', '1', 'features', '2025-10-11 16:24:57', 1),
(5, 'smtp_host', 'smtp.gmail.com', 'email', '2025-10-11 16:24:57', 1),
(6, 'smtp_port', '587', 'email', '2025-10-11 16:24:57', 1),
(7, 'smtp_username', '', 'email', '2025-10-11 16:24:57', 1),
(8, 'smtp_password', '', 'email', '2025-10-11 16:24:57', 1),
(9, 'smtp_from_email', 'noreply@codelab.help', 'email', '2025-10-11 16:24:57', 1),
(10, 'smtp_from_name', 'Code Lab @ HELP', 'email', '2025-10-11 16:24:57', 1),
(11, 'password_min_length', '8', 'security', '2025-10-11 16:24:57', 1),
(12, 'session_timeout', '1800', 'security', '2025-10-11 16:24:57', 1),
(13, 'max_login_attempts', '5', 'security', '2025-10-11 16:24:57', 1),
(14, 'default_exercise_points', '10', 'defaults', '2025-10-11 16:24:57', 1),
(15, 'default_max_attempts', '0', 'defaults', '2025-10-11 16:24:57', 1),
(16, 'notifications_enabled', '1', 'features', '2025-10-11 16:24:57', 1);

-- --------------------------------------------------------

--
-- Table structure for table `users`
--

CREATE TABLE `users` (
  `id` int(11) UNSIGNED NOT NULL,
  `full_name` varchar(100) NOT NULL,
  `email` varchar(100) NOT NULL,
  `role` enum('student','instructor','admin') NOT NULL,
  `password` varchar(255) NOT NULL,
  `created_at` timestamp NOT NULL DEFAULT current_timestamp(),
  `first_login` tinyint(1) DEFAULT 1
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

--
-- Dumping data for table `users`
--

INSERT INTO `users` (`id`, `full_name`, `email`, `role`, `password`, `created_at`, `first_login`) VALUES
(1, 'Admin', 'admin@help.com', 'admin', '$2y$10$1nOnHwZ/JA.4Gj.oANFS6uHFKuth1E3VBZH7SnBv3xX0Q3C0t6IJS', '2025-04-08 06:36:24', 0),
(2, 'test', 'test@live.com', 'instructor', '$2y$10$SGl/OMjZl6laeJvw.U4IeuM.vVE0OeepAYJ3f391.g773dcsWRq6.', '2025-04-08 06:59:31', 0),
(3, 'Test Student', 'student@help.com', 'student', '$2y$10$Pn0uUIu638gPU1sXIvXZP.j4Gbv8pzTqcS6LnSNoQ7HWHnzNsYvHe', '2025-04-08 07:00:05', 0),
(4, 'Kok Chye Hock', 'kok@help.com', 'instructor', '$2y$10$iE4piciOlET5ugjrlKsdceTnDCHthWJu8Tg0BOua3u/o/5clkf.tK', '2025-04-09 04:27:47', 0),
(5, 'Edward Wong', 'edward@help.com', 'student', '$2y$10$Zdn4Ymx9KNSUzPUkvV8kZ.INlvZog5K5QR2/uwryG7fiwlE18zgT.', '2025-04-24 06:19:20', 0);

--
-- Indexes for dumped tables
--

--
-- Indexes for table `assignments`
--
ALTER TABLE `assignments`
  ADD PRIMARY KEY (`id`),
  ADD KEY `exercise_id` (`exercise_id`),
  ADD KEY `instructor_id` (`instructor_id`),
  ADD KEY `idx_student_assignments` (`student_id`,`status`),
  ADD KEY `idx_instructor_assignments` (`instructor_id`,`status`),
  ADD KEY `idx_due_date` (`due_date`);

--
-- Indexes for table `assignment_students`
--
ALTER TABLE `assignment_students`
  ADD PRIMARY KEY (`id`),
  ADD UNIQUE KEY `unique_assignment_student` (`assignment_id`,`student_id`),
  ADD KEY `student_id` (`student_id`);

--
-- Indexes for table `exercises`
--
ALTER TABLE `exercises`
  ADD PRIMARY KEY (`id`),
  ADD KEY `lesson_id` (`lesson_id`);

--
-- Indexes for table `exercise_submissions`
--
ALTER TABLE `exercise_submissions`
  ADD PRIMARY KEY (`id`),
  ADD KEY `exercise_id` (`exercise_id`),
  ADD KEY `student_id` (`student_id`);

--
-- Indexes for table `instructor_feedback`
--
ALTER TABLE `instructor_feedback`
  ADD PRIMARY KEY (`id`),
  ADD KEY `submission_id` (`submission_id`),
  ADD KEY `instructor_id` (`instructor_id`);

--
-- Indexes for table `lessons`
--
ALTER TABLE `lessons`
  ADD PRIMARY KEY (`id`),
  ADD KEY `created_by` (`created_by`);

--
-- Indexes for table `lesson_progress`
--
ALTER TABLE `lesson_progress`
  ADD PRIMARY KEY (`id`),
  ADD UNIQUE KEY `unique_progress` (`student_id`,`topic`,`level`,`step`),
  ADD KEY `idx_student_progress` (`student_id`,`topic`,`level`);

--
-- Indexes for table `lesson_quiz_progress`
--
ALTER TABLE `lesson_quiz_progress`
  ADD PRIMARY KEY (`id`),
  ADD UNIQUE KEY `unique_student_lesson` (`student_id`,`lesson_id`);

--
-- Indexes for table `quiz_answers`
--
ALTER TABLE `quiz_answers`
  ADD PRIMARY KEY (`id`);

--
-- Indexes for table `student_progress`
--
ALTER TABLE `student_progress`
  ADD PRIMARY KEY (`id`),
  ADD UNIQUE KEY `unique_student_lesson` (`student_id`,`lesson_id`),
  ADD KEY `lesson_id` (`lesson_id`);

--
-- Indexes for table `system_settings`
--
ALTER TABLE `system_settings`
  ADD PRIMARY KEY (`id`),
  ADD UNIQUE KEY `setting_key` (`setting_key`),
  ADD KEY `updated_by` (`updated_by`);

--
-- Indexes for table `users`
--
ALTER TABLE `users`
  ADD PRIMARY KEY (`id`),
  ADD UNIQUE KEY `email` (`email`);

--
-- AUTO_INCREMENT for dumped tables
--

--
-- AUTO_INCREMENT for table `assignments`
--
ALTER TABLE `assignments`
  MODIFY `id` int(10) UNSIGNED NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=12;

--
-- AUTO_INCREMENT for table `assignment_students`
--
ALTER TABLE `assignment_students`
  MODIFY `id` int(10) UNSIGNED NOT NULL AUTO_INCREMENT;

--
-- AUTO_INCREMENT for table `exercises`
--
ALTER TABLE `exercises`
  MODIFY `id` int(10) UNSIGNED NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=11;

--
-- AUTO_INCREMENT for table `exercise_submissions`
--
ALTER TABLE `exercise_submissions`
  MODIFY `id` int(10) UNSIGNED NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=12;

--
-- AUTO_INCREMENT for table `instructor_feedback`
--
ALTER TABLE `instructor_feedback`
  MODIFY `id` int(10) UNSIGNED NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=2;

--
-- AUTO_INCREMENT for table `lessons`
--
ALTER TABLE `lessons`
  MODIFY `id` int(10) UNSIGNED NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=7;

--
-- AUTO_INCREMENT for table `lesson_progress`
--
ALTER TABLE `lesson_progress`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT;

--
-- AUTO_INCREMENT for table `lesson_quiz_progress`
--
ALTER TABLE `lesson_quiz_progress`
  MODIFY `id` int(10) UNSIGNED NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=2;

--
-- AUTO_INCREMENT for table `quiz_answers`
--
ALTER TABLE `quiz_answers`
  MODIFY `id` int(10) UNSIGNED NOT NULL AUTO_INCREMENT;

--
-- AUTO_INCREMENT for table `student_progress`
--
ALTER TABLE `student_progress`
  MODIFY `id` int(10) UNSIGNED NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=6;

--
-- AUTO_INCREMENT for table `system_settings`
--
ALTER TABLE `system_settings`
  MODIFY `id` int(11) UNSIGNED NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=81;

--
-- AUTO_INCREMENT for table `users`
--
ALTER TABLE `users`
  MODIFY `id` int(11) UNSIGNED NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=10;

--
-- Constraints for dumped tables
--

--
-- Constraints for table `assignments`
--
ALTER TABLE `assignments`
  ADD CONSTRAINT `assignments_ibfk_1` FOREIGN KEY (`exercise_id`) REFERENCES `exercises` (`id`) ON DELETE CASCADE,
  ADD CONSTRAINT `assignments_ibfk_2` FOREIGN KEY (`instructor_id`) REFERENCES `users` (`id`) ON DELETE CASCADE,
  ADD CONSTRAINT `fk_assignments_exercise` FOREIGN KEY (`exercise_id`) REFERENCES `exercises` (`id`) ON DELETE CASCADE,
  ADD CONSTRAINT `fk_assignments_instructor` FOREIGN KEY (`instructor_id`) REFERENCES `users` (`id`) ON DELETE CASCADE,
  ADD CONSTRAINT `fk_assignments_student` FOREIGN KEY (`student_id`) REFERENCES `users` (`id`) ON DELETE CASCADE;

--
-- Constraints for table `assignment_students`
--
ALTER TABLE `assignment_students`
  ADD CONSTRAINT `assignment_students_ibfk_1` FOREIGN KEY (`assignment_id`) REFERENCES `assignments` (`id`) ON DELETE CASCADE,
  ADD CONSTRAINT `assignment_students_ibfk_2` FOREIGN KEY (`student_id`) REFERENCES `users` (`id`) ON DELETE CASCADE;

--
-- Constraints for table `exercises`
--
ALTER TABLE `exercises`
  ADD CONSTRAINT `exercises_ibfk_1` FOREIGN KEY (`lesson_id`) REFERENCES `lessons` (`id`) ON DELETE CASCADE;

--
-- Constraints for table `exercise_submissions`
--
ALTER TABLE `exercise_submissions`
  ADD CONSTRAINT `exercise_submissions_ibfk_1` FOREIGN KEY (`exercise_id`) REFERENCES `exercises` (`id`) ON DELETE CASCADE,
  ADD CONSTRAINT `exercise_submissions_ibfk_2` FOREIGN KEY (`student_id`) REFERENCES `users` (`id`) ON DELETE CASCADE;

--
-- Constraints for table `instructor_feedback`
--
ALTER TABLE `instructor_feedback`
  ADD CONSTRAINT `instructor_feedback_ibfk_1` FOREIGN KEY (`submission_id`) REFERENCES `exercise_submissions` (`id`) ON DELETE CASCADE,
  ADD CONSTRAINT `instructor_feedback_ibfk_2` FOREIGN KEY (`instructor_id`) REFERENCES `users` (`id`) ON DELETE CASCADE;

--
-- Constraints for table `lessons`
--
ALTER TABLE `lessons`
  ADD CONSTRAINT `lessons_ibfk_1` FOREIGN KEY (`created_by`) REFERENCES `users` (`id`) ON DELETE SET NULL;

--
-- Constraints for table `student_progress`
--
ALTER TABLE `student_progress`
  ADD CONSTRAINT `student_progress_ibfk_1` FOREIGN KEY (`student_id`) REFERENCES `users` (`id`) ON DELETE CASCADE,
  ADD CONSTRAINT `student_progress_ibfk_2` FOREIGN KEY (`lesson_id`) REFERENCES `lessons` (`id`) ON DELETE CASCADE;

--
-- Constraints for table `system_settings`
--
ALTER TABLE `system_settings`
  ADD CONSTRAINT `system_settings_ibfk_1` FOREIGN KEY (`updated_by`) REFERENCES `users` (`id`) ON DELETE SET NULL;
COMMIT;

/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;
/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
